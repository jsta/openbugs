<!DOCTYPE html PUBLIC "-//W3C//DTD Html 1.0 Strict//EN" "http://www.w3.org/TR/Html1/DTD/strict.dtd"><html><head><title>Tricks</title></head><body><p><font face="Arial" color="#000100" size="2"><img src="tricks0.bmp" alt="[tricks0]"></font><font face="Arial" color="#000100" size="6"><strong>&nbsp;&nbsp;&nbsp;</strong></font><font face="Courier New" color="#000100" size="6">Advanced Use of the BUGS<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Language</font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#0000FF" size="2"><br></font><font face="Arial" color="#000100" size="2"><a id="Contents"></font><font face="Courier New" color="#000100" size="5">Contents</font><font face="Arial" color="#000100" size="2"></a><br></font><font face="Courier New" color="#0000FF" size="3"><br>&nbsp;&nbsp;&nbsp;<a href="#GenericDistribution">Generic&nbsp;sampling&nbsp;distribution</a><br>&nbsp;&nbsp;&nbsp;<a href="#SpecifyingANewPriorDistribution">Specifying&nbsp;a&nbsp;new&nbsp;prior&nbsp;distribution</a><br>&nbsp;&nbsp;&nbsp;<a href="#UsingPDAndDIC">Using&nbsp;pD&nbsp;and&nbsp;DIC</a><br>&nbsp;&nbsp;&nbsp;<a href="#MixturesOfModelsOfDifferentComplexity">Mixtures&nbsp;of&nbsp;models&nbsp;of&nbsp;different&nbsp;complexity</a><br>&nbsp;&nbsp;&nbsp;<a href="#WhereTheSizeOfASetIsARandomQuantity">Where&nbsp;the&nbsp;size&nbsp;of&nbsp;a&nbsp;set&nbsp;is&nbsp;a&nbsp;random&nbsp;quantity</a><br>&nbsp;&nbsp;&nbsp;<a href="#AssessingSensitivityToPriorAssumptions">Assessing&nbsp;sensitivity&nbsp;to&nbsp;prior&nbsp;assumptions</a><br>&nbsp;&nbsp;&nbsp;<a href="#ModellingUnknownDenominators">Modelling&nbsp;unknown&nbsp;denominators</a><br>&nbsp;&nbsp;&nbsp;<a href="#HandlingUnbalancedDatasets">Handling&nbsp;unbalanced&nbsp;datasets</a><br>&nbsp;&nbsp;&nbsp;<a href="#UseOfTheCutFunction">Use&nbsp;of&nbsp;the&nbsp;&quot;cut&quot;&nbsp;function</a><br></font><font face="Arial" color="#000100" size="2"><br><br><a id="GenericDistribution"></font><font face="Courier New" color="#000100" size="5">Generic sampling distribution</font><font face="Arial" color="#000100" size="2"></a> </font><font face="Courier New" color="#0000FF" size="3">[<a href="#Contents">top</a>]</font><font face="Arial" color="#0000FF" size="3"><br></font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="3">Suppose we wish to use a sampling distribution that is not included in the standard distributions (see </font><font face="Courier New" color="#0000FF" size="3"><a href="../Manuals/ModelSpecification.html#ContentsAI">Appendix&nbsp;I&nbsp;Distributions</font><font face="Arial" color="#0000FF" size="3"></a></font><font face="Arial" color="#000100" size="3">), in which an </font><font face="Arial" color="#000000" size="3">observation x[i] contributes a likelihood term L[i] </font><font face="Arial" color="#000100" size="3">(a function of x[i]). </font><font face="Arial" color="#000000" size="3">We may use the 'loglik' distribution dloglik, for a dummy observed variable:<br><br>&nbsp;&nbsp;&nbsp;dummy[i] &lt;- 0<br>&nbsp;&nbsp;&nbsp;dummy[i] ~dloglik(logLike[i])<br>&nbsp;&nbsp;&nbsp;<br>where logLike[i] is the contribution to the log-likelihood for the ith observation. The dloglik function implements the 'zero poisson' method utilized in WinBUGS.<br>&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3"><br></font><font face="Arial" color="#000000" size="3">This is illustrated in the example below in which a normal likelihood is constructed and the results are compared to the standard formulation.<br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">model {<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">for (i in 1:7) {<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">dummy[i] &lt;- 0<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">dummy[i] ~ dloglik(logLike[i])&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# likelihood is exp(logLike[i])<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# log(likelihood)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">logLike[i] &lt;- -log(sigma) - 0.5 * pow((x[i] </font><font face="Symbol" color="#000000" size="3">-</font><font face="Arial" color="#000000" size="3"> mu) / sigma, 2)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">}<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">mu ~ dunif(-10, 10)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">sigma ~ dunif(0, 10)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">}</font><font face="Arial" color="#000100" size="2"><br><br></font><font face="Arial" color="#000100" size="3"><strong>or</strong></font><font face="Arial" color="#000100" size="2"><br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">model {<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;check using normal distribution<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">for (i in 1:7) {<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">&nbsp;&nbsp;&nbsp;x[i] ~ dnorm(mu, prec)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">}<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">prec &lt;- 1 / (sigma * sigma)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">mu ~ dunif(-10, 10)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">sigma ~ dunif(0, 10)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">}</font><font face="Arial" color="#000100" size="2"><br><br><br></font><font face="Arial" color="#0000FF" size="3"><strong>Data:<br></strong></font><font face="Arial" color="#000100" size="3">list(x = c(-1, -0.3, 0.1, 0.2, 0.7, 1.2, 1.7))<br></font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#0000FF" size="3"><strong>Initial values:<br></strong></font><font face="Arial" color="#000000" size="3">list(sigma = 1, mu = 0)<br><br></font><font face="Arial" color="#0000FF" size="3"><strong>Results:</strong></font><font face="Arial" color="#000000" size="3"><br></font><font face="Arial" color="#000100" size="2"></font><font face="Arial" color="#000100" size="2"><strong>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mean&nbsp;&nbsp;&nbsp;sd&nbsp;&nbsp;&nbsp;MC_error&nbsp;&nbsp;&nbsp;val2.5pc&nbsp;&nbsp;&nbsp;median&nbsp;&nbsp;&nbsp;val97.5pc&nbsp;&nbsp;&nbsp;start&nbsp;&nbsp;&nbsp;sample<br></strong></font><font face="Arial" color="#000100" size="2">&nbsp;&nbsp;&nbsp;mu&nbsp;&nbsp;&nbsp;0.3763&nbsp;&nbsp;&nbsp;0.447&nbsp;&nbsp;&nbsp;0.01203&nbsp;&nbsp;&nbsp;-0.5436&nbsp;&nbsp;&nbsp;0.3789&nbsp;&nbsp;&nbsp;1.302&nbsp;&nbsp;&nbsp;1001&nbsp;&nbsp;&nbsp;9000<br>&nbsp;&nbsp;&nbsp;sigma&nbsp;&nbsp;&nbsp;1.145&nbsp;&nbsp;&nbsp;0.4368&nbsp;&nbsp;&nbsp;0.01743&nbsp;&nbsp;&nbsp;0.6113&nbsp;&nbsp;&nbsp;1.047&nbsp;&nbsp;&nbsp;2.263&nbsp;&nbsp;&nbsp;1001&nbsp;&nbsp;&nbsp;9000<br><br>or<br><br></font><font face="Arial" color="#000100" size="2"><strong>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mean&nbsp;&nbsp;&nbsp;sd&nbsp;&nbsp;&nbsp;MC_error&nbsp;&nbsp;&nbsp;val2.5pc&nbsp;&nbsp;&nbsp;median&nbsp;&nbsp;&nbsp;val97.5pc&nbsp;&nbsp;&nbsp;start&nbsp;&nbsp;&nbsp;sample<br></strong></font><font face="Arial" color="#000100" size="2">&nbsp;&nbsp;&nbsp;mu&nbsp;&nbsp;&nbsp;0.3642&nbsp;&nbsp;&nbsp;0.494&nbsp;&nbsp;&nbsp;0.004657&nbsp;&nbsp;&nbsp;-0.6213&nbsp;&nbsp;&nbsp;0.3663&nbsp;&nbsp;&nbsp;1.342&nbsp;&nbsp;&nbsp;1001&nbsp;&nbsp;&nbsp;9000<br>&nbsp;&nbsp;&nbsp;sigma&nbsp;&nbsp;&nbsp;1.208&nbsp;&nbsp;&nbsp;0.5572&nbsp;&nbsp;&nbsp;0.01174&nbsp;&nbsp;&nbsp;0.6299&nbsp;&nbsp;&nbsp;1.083&nbsp;&nbsp;&nbsp;2.486&nbsp;&nbsp;&nbsp;1001&nbsp;&nbsp;&nbsp;9000<br><br></font><font face="Arial" color="#000100" size="3"><br></font><font face="Arial" color="#0000FF" size="2"><br></font><font face="Arial" color="#000100" size="2"><a id="SpecifyingANewPriorDistribution"></font><font face="Courier New" color="#000100" size="5">Specifying a new prior distribution</font><font face="Arial" color="#000100" size="2"></a> </font><font face="Courier New" color="#0000FF" size="3">[<a href="#Contents">top</a>]</font><font face="Arial" color="#0000FF" size="3"><br></font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000000" size="3">For a parameter </font><font face="Arial" color="#000000" size="3"><em>theta</em></font><font face="Arial" color="#000000" size="3">, if we want to use a prior distribution </font><font face="Arial" color="#000100" size="3">not included in the standard distributions (see </font><font face="Courier New" color="#0000FF" size="3"><a href="../Manuals/ModelSpecification.html#ContentsAI">Appendix&nbsp;I&nbsp;Distributions</font><font face="Arial" color="#0000FF" size="3"></a>)</font><font face="Arial" color="#000000" size="3"> , then we can use the 'dloglik' distribution (see above) for the prior specification. A single dummy observation contributes the appropriate term to the likelihood for </font><font face="Arial" color="#000000" size="3"><em>theta</em></font><font face="Arial" color="#000000" size="3">; and when it is combined with a 'flat' prior for </font><font face="Arial" color="#000000" size="3"><em>theta,</em></font><font face="Arial" color="#000000" size="3"> the correct distribution results:<br><br></font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;theta ~ dflat()<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dummy ~dloglik(logLike)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logLike &lt;- log(</font><font face="Arial" color="#000000" size="3"><em>desired prior for theta</em></font><font face="Arial" color="#000000" size="3">)</font><font face="Arial" color="#000100" size="3"><br></font><font face="Arial" color="#000000" size="3"><br>This is illustrated by the below example in which a normal prior is constructed and the results are compared to the standard formulation. It is important to note that this method will cause the theta variable to be sampled using the metropolis algorithm and may lead to poor convergence and a high Monte Carlo error.</font><font face="Arial" color="#000000" size="2"><br></font><font face="Arial" color="#000000" size="3"><strong><br></strong></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">model {<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">for (i in 1:7) {<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">x[i] ~ dnorm(mu, prec)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">}<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">dummy &lt;- 0<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">dummy ~ dloglik(phi)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# likelihood is exp(phi)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">phi &lt;- -0.5 * pow(mu, 2)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# log(N(0, 1))<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">mu ~ dflat()&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# 'flat' prior<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">prec &lt;- 1 / (sigma * sigma)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">sigma ~ dunif(0, 10)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">}<br><br>or<br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">model {<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">for (i in 1:7) {<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">x[i] ~ dnorm(mu, prec)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mu ~ dnorm(0, 1)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# 'known' normal prior<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">prec &lt;- 1 / (sigma * sigma)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">sigma ~ dunif(0, 10)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">}<br><br></font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#0000FF" size="3"><strong>Data:<br></strong></font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;list(x = c(-1, -0.3, 0.1, 0.2, 0.7, 1.2, 1.7))<br><br></font><font face="Arial" color="#0000FF" size="3"><strong>Initial values:<br></strong></font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;list(sigma = 1, mu = 0)<br>&nbsp;&nbsp;&nbsp;<br></font><font face="Arial" color="#0000FF" size="3"><strong>Results:</strong></font><font face="Arial" color="#000100" size="3"><br></font><font face="Arial" color="#000100" size="2"></font><font face="Arial" color="#000100" size="2"><strong>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mean&nbsp;&nbsp;&nbsp;sd&nbsp;&nbsp;&nbsp;MC_error&nbsp;&nbsp;&nbsp;val2.5pc&nbsp;&nbsp;&nbsp;median&nbsp;&nbsp;&nbsp;val97.5pc&nbsp;&nbsp;&nbsp;start&nbsp;&nbsp;&nbsp;sample<br></strong></font><font face="Arial" color="#000100" size="2">&nbsp;&nbsp;&nbsp;mu&nbsp;&nbsp;&nbsp;0.2859&nbsp;&nbsp;&nbsp;0.4108&nbsp;&nbsp;&nbsp;0.008778&nbsp;&nbsp;&nbsp;-0.5574&nbsp;&nbsp;&nbsp;0.3002&nbsp;&nbsp;&nbsp;1.08&nbsp;&nbsp;&nbsp;1001&nbsp;&nbsp;&nbsp;9000<br>&nbsp;&nbsp;&nbsp;sigma&nbsp;&nbsp;&nbsp;1.162&nbsp;&nbsp;&nbsp;0.4721&nbsp;&nbsp;&nbsp;0.008885&nbsp;&nbsp;&nbsp;0.6178&nbsp;&nbsp;&nbsp;1.05&nbsp;&nbsp;&nbsp;2.359&nbsp;&nbsp;&nbsp;1001&nbsp;&nbsp;&nbsp;9000<br>&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;or<br>&nbsp;&nbsp;&nbsp;<br></font><font face="Arial" color="#000100" size="2"><strong>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mean&nbsp;&nbsp;&nbsp;sd&nbsp;&nbsp;&nbsp;MC_error&nbsp;&nbsp;&nbsp;val2.5pc&nbsp;&nbsp;&nbsp;median&nbsp;&nbsp;&nbsp;val97.5pc&nbsp;&nbsp;&nbsp;start&nbsp;&nbsp;&nbsp;sample<br></strong></font><font face="Arial" color="#000100" size="2">&nbsp;&nbsp;&nbsp;mu&nbsp;&nbsp;&nbsp;0.2973&nbsp;&nbsp;&nbsp;0.4043&nbsp;&nbsp;&nbsp;0.003525&nbsp;&nbsp;&nbsp;-0.5499&nbsp;&nbsp;&nbsp;0.3112&nbsp;&nbsp;&nbsp;1.07&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;10000<br>&nbsp;&nbsp;&nbsp;sigma&nbsp;&nbsp;&nbsp;1.166&nbsp;&nbsp;&nbsp;0.4785&nbsp;&nbsp;&nbsp;0.007654&nbsp;&nbsp;&nbsp;0.6234&nbsp;&nbsp;&nbsp;1.059&nbsp;&nbsp;&nbsp;2.315&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;10000<br><br></font><font face="Arial" color="#000100" size="3"><br></font><font face="Arial" color="#000100" size="2"><a id="UsingPDAndDIC"></font><font face="Courier New" color="#000100" size="5">Using pD and DIC</font><font face="Arial" color="#000100" size="2"></a> </font><font face="Courier New" color="#0000FF" size="3">[<a href="#Contents">top</a>]</font><font face="Arial" color="#0000FF" size="3"><br></font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000000" size="3">Here we make a number of observations regarding the use of DIC and pD </font><font face="Arial" color="#000100" size="3">-</font><font face="Arial" color="#000000" size="3"> for a full discussion see</font><font face="Courier New" color="#0000FF" size="3"> <a href="../Manuals/References.html#DICPaper">Spiegelhalter&nbsp;et&nbsp;al.&nbsp;(2002)</a>:</font><font face="Arial" color="#000000" size="3"><br></font><font face="Arial" color="#000000" size="2"><br></font><font face="Arial" color="#000000" size="3">1) DIC is intended as a generalisation of Akaike's Information Criterion (AIC). For non-hierarchical models, pD should be approximately the true number of parameters.<br><br>2) Slightly different values of Dhat (and hence pD and DIC) can be obtained depending on the parameterisation used for the prior distribution. For example, consider the precision </font><font face="Arial" color="#000000" size="3"><em>tau</em></font><font face="Arial" color="#000000" size="3"> (1 / variance) of a normal distribution. The two priors<br></font><font face="Arial" color="#000100" size="3"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tau ~ dgamma(0.001, 0.001)</font><font face="Arial" color="#000000" size="3"> and<br></font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;log.tau ~ dunif(-10, 10); log(tau) &lt;- log.tau</font><font face="Arial" color="#000000" size="3"><br></font><font face="Arial" color="#000100" size="3"><br></font><font face="Arial" color="#000000" size="3">are essentially identical but will give slightly different results for Dhat. The first prior distribution has stochastic parent </font><font face="Arial" color="#000000" size="3"><em>tau</em></font><font face="Arial" color="#000000" size="3"> and hence the posterior mean of </font><font face="Arial" color="#000000" size="3"><em>tau</em></font><font face="Arial" color="#000000" size="3"> is substituted in Dhat, while in the second parameterisation the stochastic parent is </font><font face="Arial" color="#000000" size="3"><em>log.tau</em></font><font face="Arial" color="#000000" size="3"> and hence the posterior mean of log(</font><font face="Arial" color="#000000" size="3"><em>tau</em></font><font face="Arial" color="#000000" size="3">) is substituted in Dhat.<br><br>3) For sampling distributions that are log-concave in their stochastic parents, pD is guaranteed to be positive (provided the simulation has converged). However, we have obtained negative pD's in the following situations:</font><font face="Arial" color="#000000" size="2"><br><br></font><font face="Arial" color="#000000" size="3">i) with non-log-concave likelihoods (e.g. Student-t distributions) when there is substantial conflict between prior and data;<br>ii) when the posterior distribution for a parameter is symmetric and bimodal, and so the posterior mean is a very poor summary statistic and gives a very large deviance.</font><font face="Arial" color="#000000" size="2"><br><br></font><font face="Arial" color="#000000" size="3">4) No MC error is available on the DIC. MC error on Dbar can be obtained by monitoring deviance and is generally quite small. The primary concern is to ensure convergence of Dbar </font><font face="Arial" color="#000100" size="3">-</font><font face="Arial" color="#000000" size="3"> it is therefore worthwhile checking the stability of Dbar over a long chain.<br><br>5) The minimum DIC estimates the model that will make the best short-term predictions, in the same spirit as Akaike's criterion. However, if the difference in DIC is, say, less than 5, and the models make very different inferences, then it could be misleading just to report the model with the lowest DIC.<br><br>6) DICs are comparable only over models with exactly the same observed data, but there is no need for them to be nested.<br><br>7) DIC differs from Bayes factors and BIC in both form and aims.<br><br>8) Caution is advisable in the use of DIC until more experience has been gained. </font><font face="Arial" color="#000000" size="3"><strong>It is important to note that the calculation of DIC will be disallowed for certain models. <br></strong></font><font face="Arial" color="#000000" size="2"><br><br></font><font face="Arial" color="#000100" size="2"><a id="MixturesOfModelsOfDifferentComplexity"></font><font face="Courier New" color="#000100" size="5">Mixtures of models of different complexity</font><font face="Arial" color="#000100" size="2"></a> </font><font face="Courier New" color="#0000FF" size="3">[<a href="#Contents">top</a>]</font><font face="Arial" color="#0000FF" size="3"><br></font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000000" size="3">Suppose we assume that each observation, or group of observations, is from one of a set of distributions, where the members of the set have different complexity. For example, we may think data for each person's growth curve comes from either a linear or quadratic line. We might think we would require 'reversible jump' techniques, but this is not the case as we are really only considering a single mixture model as a sampling distribution. Thus standard methods for setting up mixture distributions can be adopted, but with components having different numbers of parameters.<br><br>The below example illustrates how this is handled in </font><font face="Arial" color="#000000" size="3"><em>OpenBUGS</em></font><font face="Arial" color="#000000" size="3">, using a set of simulated data.<br><br>Suppose that for each i: x[i] ~ N(mu, 1) with probability p; and x[i] ~ N(0, 1) otherwise (i.e. with probability 1 - p). We generate 100 observations with p = 0.4 and mu = 3 as follows. We forward sample </font><font face="Arial" color="#000000" size="3"><em>once</em></font><font face="Arial" color="#000000" size="3"> from the model below by compiling the code and then using the 'gen inits' facility. The simulated data can then be obtained by selecting </font><font face="Arial" color="#000000" size="3"><em>Save State</em></font><font face="Arial" color="#000000" size="3"> from the </font><font face="Arial" color="#000000" size="3"><em>Model</em></font><font face="Arial" color="#000000" size="3"> menu.<br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">model {<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">&nbsp;&nbsp;&nbsp;mu &lt;- 3<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">&nbsp;&nbsp;&nbsp;p &lt;- 0.4<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">&nbsp;&nbsp;&nbsp;m[1] &lt;- 0<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">&nbsp;&nbsp;&nbsp;m[2] &lt;- mu<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">&nbsp;&nbsp;&nbsp;for (i in 1 : 100) {<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;group[i] ~ dbern(p)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;index[i] &lt;- group[i] + 1<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y[i] ~ dnorm(m[index[i]], 1)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">&nbsp;&nbsp;&nbsp;}<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">}<br><br>We may observe the underlying mixture distribution by monitoring any one of the y[i]'s over a number of additional sampling cycles. For example, the following kernel density plot was obtained after monitoring y[1] for 1000 iterations:<br><br></font><font face="Arial" color="#000100" size="2"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<img src="tricks1.bmp" alt="[tricks1]"></font><font face="Arial" color="#000100" size="5"><br></font><font face="Arial" color="#0000FF" size="2">T</font><font face="Arial" color="#000000" size="3">o analyse the simulated data we use the following code:<br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">model {<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">&nbsp;&nbsp;&nbsp;mu ~ dunif(-5, 5)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">&nbsp;&nbsp;&nbsp;p ~ dunif(0, 1)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">&nbsp;&nbsp;&nbsp;m[1] &lt;- 0<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">&nbsp;&nbsp;&nbsp;m[2] &lt;- mu<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">&nbsp;&nbsp;&nbsp;for (i in 1:100) {<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;group[i] ~ dbern(p)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;index[i] &lt;- group[i] + 1<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y[i] ~ dnorm(m[index[i]], 1)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">&nbsp;&nbsp;&nbsp;}<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">}<br><br>After 101000 iterations (with a burn-in of 1000) we have good agreement with the 'true' values:<br><br></font><font face="Arial" color="#000100" size="2"></font><font face="Arial" color="#000100" size="2"><strong>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mean&nbsp;&nbsp;&nbsp;sd&nbsp;&nbsp;&nbsp;MC_error&nbsp;&nbsp;&nbsp;val2.5pc&nbsp;&nbsp;&nbsp;median&nbsp;&nbsp;&nbsp;val97.5pc&nbsp;&nbsp;&nbsp;start&nbsp;&nbsp;&nbsp;sample<br></strong></font><font face="Arial" color="#000100" size="2">&nbsp;&nbsp;&nbsp;mu&nbsp;&nbsp;&nbsp;3.058&nbsp;&nbsp;&nbsp;0.2071&nbsp;&nbsp;&nbsp;0.001288&nbsp;&nbsp;&nbsp;2.655&nbsp;&nbsp;&nbsp;3.056&nbsp;&nbsp;&nbsp;3.472&nbsp;&nbsp;&nbsp;1001&nbsp;&nbsp;&nbsp;100000<br>&nbsp;&nbsp;&nbsp;p&nbsp;&nbsp;&nbsp;0.4243&nbsp;&nbsp;&nbsp;0.05985&nbsp;&nbsp;&nbsp;3.718E-4&nbsp;&nbsp;&nbsp;0.3098&nbsp;&nbsp;&nbsp;0.4232&nbsp;&nbsp;&nbsp;0.5438&nbsp;&nbsp;&nbsp;1001&nbsp;&nbsp;&nbsp;100000<br></font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#0000FF" size="5">Initial values</font><font face="Arial" color="#000000" size="3">:<br></font><font face="Arial" color="#000000" size="3"><strong><br></strong></font><font face="Arial" color="#000000" size="3">&nbsp;&nbsp;&nbsp;list(mu = 0, p = 0.5)<br><br></font><font face="Arial" color="#0000FF" size="5">Simulated data:</font><font face="Arial" color="#000000" size="3"><br></font><font face="Arial" color="#000000" size="3"><strong><br></strong></font><font face="Arial" color="#000000" size="2">list(<br>y = c(<br>2.401893189187883,0.2400077667887621,-0.1556589480882761,-0.8457182007723154,0.37008097263224,<br>3.586009960655263,1.598955590680827,3.826518138558907,-0.9630895329522409,0.6951468806412424,<br>3.129328672725175,0.01025316168135796,0.4887298480200992,0.3865632519840305,-0.2697534502300845,<br>-1.18891944058751,4.654771935717583,0.8063807170988319,-0.9867060769784521,0.9154433557950319,<br>-0.5419217214549653,3.358942981432516,3.33734145389337,3.3960739633218,2.038185222382867,<br>5.241414085016386,3.362823353717864,-0.6013483154102028,0.441480491316843,2.96228336554288,<br>-2.278054802181326,1.446861613005477,1.49864667127073,2.819410923921955,3.668112206659865,<br>0.8253991892717565,1.117718710956935,3.976040128045549,1.261678474198661,-0.03343173803015926,<br>-0.4908566523519207,0.3532664087054739,-1.679362022373703,-1.555760053262808,1.213022071911081,<br>3.421072023150202,2.523431239569371,-1.218844344999495,-0.270208787763775,-0.1217560919494103,<br>2.033835091596821,0.4654798734609423,-0.7231540561359688,2.146640407714382,4.286633169106659,<br>1.445348149793759,0.180718235361594,1.527791426438174,-1.010060680847808,1.969758236040937,<br>-0.3553936244225268,1.465488166547136,3.32669874753109,1.061348836020805,2.31746192198435,<br>0.9564080472865206,1.877477903911581,-0.6964242592539615,5.695159167887606,2.807268123194206,<br>-1.69815612298043,0.1881330355284009,0.04018232765300667,2.272096174325846,0.9694913345710192,<br>3.979152197443702,-0.7028546956095989,1.371423010966528,1.646618045628321,0.1919331499516834,<br>3.587928853903195,0.1219688057614579,2.570950727333546,1.888563572434331,1.10249950266553,<br>4.119103539377994,3.824513529111282,1.509248826260637,1.156700011660602,-0.0343697724869282,<br>3.816521442901518,0.0675520018218364,-0.002197033376085265,2.994147650487649,1.856351699226103,<br>3.539838516568062,0.5861211569557628,4.343058450523658,0.1760647082096519,3.678908111531086))<br></font><font face="Arial" color="#000000" size="3"><br>Naturally, the standard warnings about mixture distributions apply, in that convergence may be poor and careful parameterisation may be necessary to avoid some of the components becoming empty.<br><br></font><font face="Arial" color="#000000" size="2"><br></font><font face="Courier New" color="#000100" size="5"><a id="WhereTheSizeOfASetIsARandomQuantity">Where the size of a set is a random quantity</font><font face="Arial" color="#000100" size="2"></a> </font><font face="Courier New" color="#0000FF" size="3">[<a href="#Contents">top</a>]</font><font face="Arial" color="#0000FF" size="3"><br></font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000000" size="3">Suppose the size of a set is a random quantity: this naturally occurs in 'changepoint' problems where observations up to an unknown changepoint K come from one model, and after K come from another. Note that we </font><font face="Arial" color="#000000" size="3"><strong>cannot</strong></font><font face="Arial" color="#000000" size="3"> use the construction<br><br></font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for (i in 1:K) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y[i] ~ </font><font face="Arial" color="#000000" size="3"><em>model 1</em></font><font face="Arial" color="#000100" size="3"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for (i in (K + 1):N) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y[i] ~ </font><font face="Arial" color="#000000" size="3"><em>model 2</em></font><font face="Arial" color="#000100" size="3"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br></font><font face="Arial" color="#0000FF" size="3"><br></font><font face="Arial" color="#000000" size="3">since the index for a loop cannot be a random quantity. Instead we can use the step function to set up an indicator as to which set each observation belongs to:<br><br></font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for (i in 1:N) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ind[i] &lt;- 1 + step(i - K - 0.01)</font><font face="Arial" color="#000000" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# will be 1 for all i &lt;= K, 2 otherwise</font><font face="Arial" color="#000100" size="3"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y[i] ~ </font><font face="Arial" color="#000000" size="3"><em>model </em></font><font face="Arial" color="#000100" size="3">ind[i]<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br></font><font face="Arial" color="#000000" size="3"><br>This is illustrated by the problem of adding up terms in a series of unknown length.<br><br>Suppose we want to find the distribution of the sum of the first K integers, where K is a random quantity. We shall assume K has a uniform distribution on 1 to 10. <br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">&nbsp;&nbsp;&nbsp;model <br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">&nbsp;&nbsp;&nbsp;{<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">&nbsp;&nbsp;&nbsp;for (i in 1:10) {<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p[i] &lt;- 1 / 10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# set up prior for K<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x[i] &lt;- i&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# set up array of integers<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">&nbsp;&nbsp;&nbsp;}<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">&nbsp;&nbsp;&nbsp;K ~ dcat(p[])&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# sample K from its prior<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">&nbsp;&nbsp;&nbsp;for (i in 1:10) {<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3"># determine which of the x[i]'s are to be summed<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xtosum[i] &lt;- x[i] * step(K - i + 0.01)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">&nbsp;&nbsp;&nbsp;}<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">&nbsp;&nbsp;&nbsp;s &lt;- sum(xtosum[])<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">&nbsp;&nbsp;&nbsp;}<br><br></font><font face="Arial" color="#000100" size="2"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<img src="tricks2.bmp" alt="[tricks2]"></font><font face="Arial" color="#000100" size="3"></font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000000" size="3"><br></font><font face="Arial" color="#0000FF" size="2"><br></font><font face="Courier New" color="#000100" size="5"><a id="AssessingSensitivityToPriorAssumptions">Assessing sensitivity to prior assumptions</font><font face="Arial" color="#000100" size="2"></a> </font><font face="Courier New" color="#0000FF" size="3">[<a href="#Contents">top</a>]</font><font face="Arial" color="#0000FF" size="3"><br></font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000000" size="3">One way to do this is to repeat the analysis under different prior assumptions, but within the same simulation in order to aid direct comparison of results. Assuming the consequences of K prior distributions are to be compared:<br></font><font face="Arial" color="#000000" size="2"><br></font><font face="Arial" color="#000000" size="3">a) replicate the dataset K times within the model code;<br>b) set up a loop to repeat the analysis for each prior, holding results in arrays;<br>c) compare results using the </font><font face="Courier New" color="#0000FF" size="3"><a href="../Manuals/InferenceMenu.html#Compare">'compare'</a> </font><font face="Arial" color="#000000" size="3">facility.</font><font face="Arial" color="#000000" size="2"><br><br></font><font face="Arial" color="#000000" size="3">The example</font><font face="Courier New" color="#0000FF" size="3"> <a href="../Examples/Magnesium.html"></font><font face="Arial" color="#0000FF" size="3">prior-sensitivity</a></font><font face="Arial" color="#000000" size="3"> explores six different suggestions for priors on the random-effects variance in a meta-analysis.<br><br></font><font face="Arial" color="#000100" size="2"><br><a id="ModellingUnknownDenominators"></font><font face="Courier New" color="#000100" size="5">Modelling unknown denominators</a></font><font face="Arial" color="#000100" size="2"> </font><font face="Courier New" color="#0000FF" size="3">[<a href="#Contents">top</a>]</font><font face="Arial" color="#0000FF" size="3"><br></font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000000" size="3">Suppose we have an unknown Binomial denominator for which we wish to express a prior distribution. It can be given a Poisson prior but this makes it difficult to express a reasonably uniform distribution. Alternatively a continuous distribution could be specified and then the 'round' function used. For example, suppose we are told that a fair coin has come up heads 10 times </font><font face="Arial" color="#000100" size="3">-</font><font face="Arial" color="#000000" size="3"> how many times has it been tossed?<br><br></font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;model {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;r &lt;- 10<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p &lt;- 0.5<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;r ~ dbin(p, n)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;n.cont ~ dunif(1, 100)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;n &lt;- round(n.cont)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br></font><font face="Arial" color="#000000" size="2"><br></font><font face="Arial" color="#000100" size="3"><strong>&nbsp;&nbsp;&nbsp;node&nbsp;&nbsp;&nbsp;mean&nbsp;&nbsp;&nbsp;sd&nbsp;&nbsp;&nbsp;MC error&nbsp;&nbsp;&nbsp;2.5%&nbsp;&nbsp;&nbsp;median&nbsp;&nbsp;&nbsp;97.5%&nbsp;&nbsp;&nbsp;start&nbsp;&nbsp;&nbsp;sample<br></strong></font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;n&nbsp;&nbsp;&nbsp;21.08&nbsp;&nbsp;&nbsp;4.794&nbsp;&nbsp;&nbsp;0.07906&nbsp;&nbsp;&nbsp;13.0&nbsp;&nbsp;&nbsp;21.0&nbsp;&nbsp;&nbsp;32.0&nbsp;&nbsp;&nbsp;1001&nbsp;&nbsp;&nbsp;5000<br>&nbsp;&nbsp;&nbsp;n.cont&nbsp;&nbsp;&nbsp;21.08&nbsp;&nbsp;&nbsp;4.804&nbsp;&nbsp;&nbsp;0.07932&nbsp;&nbsp;&nbsp;13.31&nbsp;&nbsp;&nbsp;20.6&nbsp;&nbsp;&nbsp;32.0&nbsp;&nbsp;&nbsp;1001&nbsp;&nbsp;&nbsp;5000<br>&nbsp;&nbsp;&nbsp;<br></font><font face="Arial" color="#000000" size="3">Assuming a uniform prior for the number of tosses, we can be 95% sure that the coin has been tossed between 13 and 32 times. </font><font face="Arial" color="#000100" size="3">A discrete prior on the integers could also have been used in this context.<br><br></font><font face="Arial" color="#000100" size="2"><br></font><font face="Courier New" color="#000100" size="5"><a id="HandlingUnbalancedDatasets">Handling unbalanced datasets</font><font face="Arial" color="#000100" size="2"></a> </font><font face="Courier New" color="#0000FF" size="3">[<a href="#Contents">top</a>]</font><font face="Arial" color="#0000FF" size="3"><br></font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000000" size="3">Suppose we observe the following data on three individuals:<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Person 1: 13.2<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Person 2: 12.3 , 14.1<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Person 3: 11.0, 9.7, 10.3, 9.6<br>&nbsp;&nbsp;&nbsp;<br>There are three different ways of entering such 'ragged' data into WinBUGS:<br><br></font><font face="Arial" color="#000000" size="3"><strong>1. Fill-to-rectangular:</strong></font><font face="Arial" color="#000000" size="3"> Here the data is 'padded out' by explicitly including the missing data, i.e.<br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;y[,1]&nbsp;&nbsp;&nbsp;y[,2]&nbsp;&nbsp;&nbsp;y[,3]&nbsp;&nbsp;&nbsp;y[,4]<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;13.2&nbsp;&nbsp;&nbsp;NA&nbsp;&nbsp;&nbsp;NA&nbsp;&nbsp;&nbsp;NA<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;12.3&nbsp;&nbsp;&nbsp;14.1&nbsp;&nbsp;&nbsp;NA&nbsp;&nbsp;&nbsp;NA<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;11.0&nbsp;&nbsp;&nbsp;9.7&nbsp;&nbsp;&nbsp;10.3&nbsp;&nbsp;&nbsp;9.6<br></font><font face="Arial" color="#000100" size="1"></font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END<br></font><font face="Arial" color="#000000" size="2"><br></font><font face="Arial" color="#000000" size="3">or list(y = structure(.Data = c(13.2, NA, NA, NA, 12.3, 14.1, NA, NA, 11.0, 9.7, 10.3, 9.6), .<br>Dim = c(3, 4)).<br><br>A model such as </font><font face="Arial" color="#000100" size="3">y[i, j] ~ dnorm(mu[i], 1)</font><font face="Arial" color="#000000" size="3"> can then be fitted. This approach is inefficient unless one explicitly wishes to estimate the missing data.<br><br></font><font face="Arial" color="#000000" size="3"><strong>2. Nested indexing:</strong></font><font face="Arial" color="#000000" size="3"> Here the data are stored in a single array and the associated person is recorded as a factor, i.e.<br></font><font face="Arial" color="#000000" size="2"><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;y[]&nbsp;&nbsp;&nbsp;person[]<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;13.2&nbsp;&nbsp;&nbsp;1<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;12.3&nbsp;&nbsp;&nbsp;2<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;14.1&nbsp;&nbsp;&nbsp;2<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;11.0&nbsp;&nbsp;&nbsp;3<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;9.7&nbsp;&nbsp;&nbsp;3<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;10.3&nbsp;&nbsp;&nbsp;3<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;9.6&nbsp;&nbsp;&nbsp;3<br></font><font face="Arial" color="#000100" size="1"></font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END<br></font><font face="Arial" color="#000000" size="2"><br></font><font face="Arial" color="#000000" size="3">or list(y = c(13.2, 12.3, 14.1, 11.0, 9.7, 10.3, 9.6), person = c(1, 2, 2, 3, 3, 3, 3)).<br><br>A model such as </font><font face="Arial" color="#000100" size="3">y[k] ~ dnorm(mu[person[k]], 1)</font><font face="Arial" color="#000000" size="3"> can then be fitted. This seems an efficient and clear way to handle the problem.<br><br></font><font face="Arial" color="#000000" size="3"><strong>3. Offset: </strong></font><font face="Arial" color="#000000" size="3">Here an 'offset' array holds the position in the data array at which each </font><font face="Arial" color="#000100" size="3">person's data starts. For example, the data might be</font><font face="Arial" color="#000000" size="3"><br><br>list(y = c(13.2, 12.3, 14.1, 11.0, 9.7, 10.3, 9.6), offset = c(1, 2, 4, 8))<br><br>and lead to a model containing the code<br></font><font face="Arial" color="#000100" size="3"><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;for (k in offset[i]:(offset[i + 1] - 1)) {<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y[k] ~ dnorm(mu[i], 1)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;}<br><br>The danger with this method is that it relies on getting the offsets correct and they are difficult to check. <br><br>The three methods are illustrated in the small example below.<br></font><font face="Arial" color="#000000" size="3"><br></font><font face="Arial" color="#000000" size="3"><strong>Fill-to-rectangular:<br></strong></font><font face="Arial" color="#000100" size="3"><strong><br></strong></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">model {<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for (i in 1:3) {<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mu[i] ~ dunif(0, 100)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for (j in 1:4) {<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y[i, j] ~ dnorm(mu[i], 1)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;}</font><font face="Arial" color="#000100" size="2"><br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="2">y[, 1]&nbsp;&nbsp;&nbsp;y[, 2]&nbsp;&nbsp;&nbsp;y[, 3]&nbsp;&nbsp;&nbsp;y[, 4]<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="2">13.2&nbsp;&nbsp;&nbsp;NA&nbsp;&nbsp;&nbsp;NA&nbsp;&nbsp;&nbsp;NA<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="2">12.3&nbsp;&nbsp;&nbsp;14.1&nbsp;&nbsp;&nbsp;NA&nbsp;&nbsp;&nbsp;NA<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="2">11.0&nbsp;&nbsp;&nbsp;9.7&nbsp;&nbsp;&nbsp;10.3&nbsp;&nbsp;&nbsp;9.6<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="2">END<br></font><font face="Arial" color="#000000" size="2"><br></font><font face="Arial" color="#000100" size="2">list(y = structure(.Data = c(13.2, NA, NA, NA, 12.3, 14.1, NA, NA, 11.0, 9.7, 10.3, 9.6), .Dim = c(3, 4))<br></font><font face="Arial" color="#000000" size="2"><br></font><font face="Arial" color="#000000" size="3"><strong>Nested indexing:<br></strong></font><font face="Arial" color="#0000FF" size="3"><strong><br></strong></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">model <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;for (i in 1:3) {<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mu[i] ~ dunif(0, 100)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;}<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;for (k in 1:7) {<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y[k] ~ dnorm(mu[person[k]], 1)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;}<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">}</font><font face="Arial" color="#000100" size="2"><br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="2">y[]&nbsp;&nbsp;&nbsp;person[]<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="2">13.2&nbsp;&nbsp;&nbsp;1<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="2">12.3&nbsp;&nbsp;&nbsp;2<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="2">14.1&nbsp;&nbsp;&nbsp;2<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="2">11.0&nbsp;&nbsp;&nbsp;3<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="2">9.7&nbsp;&nbsp;&nbsp;3<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="2">10.3&nbsp;&nbsp;&nbsp;3<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="2">9.6&nbsp;&nbsp;&nbsp;3<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="2">END<br></font><font face="Arial" color="#000000" size="2"><br></font><font face="Arial" color="#000100" size="2">list(y = c(13.2, 12.3, 14.1, 11.0, 9.7, 10.3, 9.6), person = c(1, 2, 2, 3, 3, 3, 3))<br></font><font face="Arial" color="#000000" size="3"><br></font><font face="Arial" color="#000000" size="2"><br></font><font face="Arial" color="#000000" size="3"><strong>Offset:<br><br></strong></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">model {<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">&nbsp;&nbsp;&nbsp;for (i in 1:3) {<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mu[i] ~ dunif(0, 100)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for (k in offset[i]:(offset[i + 1] - 1)) {<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y[k] ~ dnorm(mu[i], 1)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">&nbsp;&nbsp;&nbsp;}<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">}</font><font face="Arial" color="#000100" size="2"><br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="2">y[]<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="2">13.2<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="2">12.3<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="2">14.1<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="2">11.0<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="2">9.7<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="2">10.3<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="2">9.6<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="2">END<br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="2">offset[]<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="2">1<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="2">2<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="2">4<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="2">8<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="2">END<br><br>list(y = c(13.2, 12.3, 14.1, 11.0, 9.7, 10.3, 9.6), offset = c(1, 2, 4, 8))<br><br><br></font><font face="Courier New" color="#000100" size="5"><a id="UseOfTheCutFunction">Use of the &quot;cut&quot; function</font><font face="Arial" color="#000100" size="2"></a> </font><font face="Courier New" color="#0000FF" size="3">[<a href="#Contents">top</a>]</font><font face="Arial" color="#0000FF" size="3"><br></font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000000" size="3">Suppose we observe some data that we do not wish to contribute to the parameter estimation and yet we wish to consider as part of the model. This might happen, for example:<br><br>a) when we wish to make predictions on some individuals on whom we have observed some partial data that we do not wish to use for parameter estimation;<br>b) when we want to use data to learn about some parameters and not others;<br>c) when we want evidence from one part of a model to form a prior distribution for a second part of the model, but we do not want 'feedback' from this second part.<br><br>The &quot;cut&quot; function forms a kind of 'valve' in the graph: prior information is allowed to flow 'downwards' through the cut, but likelihood information is prevented from flowing upwards.<br><br>For example, the following code leaves the distribution for theta unchanged by the observation y.<br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;model <br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;{<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y &lt;- 2<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y ~ dnorm(theta.cut, 1)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;theta.cut &lt;- cut(theta)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;theta ~ dnorm(0, 1)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;}<br></font><font face="Arial" color="#000000" size="2"><br></font></p></body></html>