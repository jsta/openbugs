<!DOCTYPE html PUBLIC "-//W3C//DTD Html 1.0 Strict//EN" "http://www.w3.org/TR/Html1/DTD/strict.dtd"><html><head><title>Kidney</title></head><body><p><font face="Arial" color="#000100" size="2"></font><font face="Arial" color="#000100" size="3"><strong><img src="kidney0.bmp" alt="[kidney0]"></strong></font><font face="Arial" color="#0000FF" size="5"><strong>&nbsp;&nbsp;&nbsp;</strong></font><font face="Courier New" color="#000100" size="6">Kidney: Weibull regression with<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;random efects</font><font face="Arial" color="#0000FF" size="5"><strong><br></strong></font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="3">McGilchrist and Aisbett (1991) analyse time to first and second recurrence of infection in kidney patients on dialysis using a Cox model with a multiplicative frailty parameter for each individual. The risk variables considered are age, sex and underlying disease (coded other, GN, AN and PKD). A portion of the data are shown below.<br><center><br></font><font face="Arial" color="#000100" size="2"><img src="kidney1.bmp" alt="[kidney1]"></font><font face="Arial" color="#000100" size="3"><br></center></font><font face="Arial" color="#000100" size="3"><br>We have analysed the same data assuming a parametric Weibull distribution for the survivor function, and including an additive random effect b</font><font face="Arial" color="#000100" size="3"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> for each patient in the exponent of the hazard model as follows<br><br>&nbsp;&nbsp;&nbsp;t</font><font face="Arial" color="#000100" size="2"><sub>ij</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">~ Weibull(r, </font><font face="Symbol" color="#000100" size="3">m</font><font face="Arial" color="#000100" size="2"><sub>ij</sub></font><font face="Arial" color="#000100" size="3">) i = 1,...,38; j = 1,2<br>&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;log</font><font face="Symbol" color="#000100" size="3">m</font><font face="Arial" color="#000100" size="2"><sub>ij</sub></font><font face="Arial" color="#000100" size="3"> = </font><font face="Symbol" color="#000100" size="3">a</font><font face="Arial" color="#000100" size="3"> + </font><font face="Symbol" color="#000100" size="3">b</font><font face="Arial" color="#000100" size="2"><sub>age</sub></font><font face="Arial" color="#000100" size="3">AGE</font><font face="Arial" color="#000100" size="2"><sub>ij</sub></font><font face="Arial" color="#000100" size="3"> + </font><font face="Symbol" color="#000100" size="3">b</font><font face="Arial" color="#000100" size="2"><sub>sex</sub></font><font face="Arial" color="#000100" size="3">SEX</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> + </font><font face="Symbol" color="#000100" size="3">b</font><font face="Arial" color="#000100" size="2"><sub>disease1</sub></font><font face="Arial" color="#000100" size="3">DISEASE</font><font face="Arial" color="#000100" size="2"><sub>i1</sub></font><font face="Arial" color="#000100" size="3"> +<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3">b</font><font face="Arial" color="#000100" size="2"><sub>disease2</sub></font><font face="Arial" color="#000100" size="3">DISEASE</font><font face="Arial" color="#000100" size="2"><sub>i2</sub></font><font face="Arial" color="#000100" size="3"> + </font><font face="Symbol" color="#000100" size="3">b</font><font face="Arial" color="#000100" size="2"><sub>disease3</sub></font><font face="Arial" color="#000100" size="3">DISEASE</font><font face="Arial" color="#000100" size="2"><sub>i3</sub></font><font face="Arial" color="#000100" size="3"> + b</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;b</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> ~ Normal(0, </font><font face="Symbol" color="#000100" size="3">t</font><font face="Arial" color="#000100" size="3">)<br>&nbsp;&nbsp;&nbsp;<br>where AGE</font><font face="Arial" color="#000100" size="2"><sub>ij</sub></font><font face="Arial" color="#000100" size="3"> is a continuous covariate, SEX</font><font face="Arial" color="#000100" size="3"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> is a 2-level factor and DISEASE</font><font face="Arial" color="#000100" size="2"><sub>ik</sub></font><font face="Arial" color="#000100" size="3"> (k = 1,2,3) are dummy variables representing the 4-level factor for underlying disease. Note that the the survival distribution is a truncated Weibull for censored observations as discussed in the mice example. The regression coefficients and the precision of the random effects </font><font face="Symbol" color="#000100" size="3">t</font><font face="Arial" color="#000100" size="3"> are given independent ``non-informative'' priors, namely&nbsp;&nbsp;&nbsp;<br><br>&nbsp;&nbsp;&nbsp;b</font><font face="Arial" color="#000100" size="2"><sub>k</sub></font><font face="Arial" color="#000100" size="3"> ~ Normal(0, 0.0001)<br>&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3">t</font><font face="Arial" color="#000100" size="3"> ~ Gamma(0.0001, 0.0001)<br>&nbsp;&nbsp;&nbsp;<br>The shape parameter of the survival distribution r is given a Gamma(1, 0.0001) prior which is slowly decreasing on the positive real line.<br><br>The graphical model and </font><font face="Arial" color="#000100" size="3"><em>BUGS</em></font><font face="Arial" color="#000100" size="3"> language are given below. <br></font><font face="Arial" color="#000100" size="2"><br><center><br></font><font face="Arial" color="#000100" size="3"><em>Graphical model for kidney example:</em></font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;<img src="kidney2.bmp" alt="[kidney2]"></font><font face="Arial" color="#000100" size="2"><br><br></font><font face="Arial" color="#000100" size="3"><br></font><font face="Arial" color="#000100" size="3">BUGS</font><font face="Arial" color="#000100" size="3"><em> language for kidney example</em></font><font face="Arial" color="#000100" size="3"><br></font><font face="Arial" color="#000100" size="3"><br></font><font face="Arial" color="#000100" size="3"></center>&nbsp;&nbsp;&nbsp;model<br>&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for (i in 1 : N) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for (j in 1 : M) {<br>&nbsp;&nbsp;&nbsp;# Survival times bounded below by censoring times:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;t[i,j] ~ dweib(r, mu[i,j])C(t.cen[i, j], );<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;log(mu[i,j ]) &lt;- alpha + beta.age * age[i, j] <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ beta.sex *sex[i] <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ beta.dis[disease[i]] + b[i];<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cumulative.t[i,j] &lt;- cumulative(t[i,j], t[i,j])<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;# Random effects:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b[i] ~ dnorm(0.0, tau) <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;# Priors:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;alpha ~ dnorm(0.0, 0.0001);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;beta.age ~ dnorm(0.0, 0.0001);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;beta.sex ~ dnorm(0.0, 0.0001);<br>&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;&nbsp;beta.dis[1] &lt;- 0; # corner-point constraint<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for(k in 2 : 4) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;beta.dis[k] ~ dnorm(0.0, 0.0001);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tau ~ dgamma(1.0E-3, 1.0E-3);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;r ~ dgamma(1.0, 1.0E-3); <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sigma &lt;- 1 / sqrt(tau); # s.d. of random effects<br>&nbsp;&nbsp;&nbsp;}<br></font><font face="Arial" color="#000100" size="1"><br><br></font><font face="Arial" color="#0000FF" size="5"><a href="../Examples/Kidneydata.html"></font><font face="Arial" color="#0000FF" size="5"><u>Data</u></font><font face="Arial" color="#0000FF" size="5"></a></font><font face="Arial" color="#000100" size="3"> ( click to open )</font><font face="Arial" color="#0000FF" size="5"><br></font><font face="Arial" color="#000000" size="2"><br></font><font face="Arial" color="#0000FF" size="5"><a href="../Examples/Kidneyinits.html"></font><font face="Arial" color="#0000FF" size="5"><u>Inits&nbsp;for&nbsp;chain&nbsp;1</a></u></font><font face="Arial" color="#000100" size="3"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#0000FF" size="5"><a href="../Examples/Kidneyinits1.html"></font><font face="Arial" color="#0000FF" size="5"><u>Inits&nbsp;for&nbsp;chain&nbsp;2</a></u></font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;( click to open )</font><font face="Arial" color="#000100" size="1"><br><br></font><font face="Arial" color="#0000FF" size="5">Results</font><font face="Arial" color="#000000" size="2"><br></font><font face="Arial" color="#000000" size="3"><br>A 1000 update burn in followed by a further 10000 updates gave the parameter estimates<br><center><br><img src="kidney3.bmp" alt="[kidney3]"></font><font face="Arial" color="#0000FF" size="5"><br><br></font></center></p></body></html>