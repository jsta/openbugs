<!DOCTYPE html PUBLIC "-//W3C//DTD Html 1.0 Strict//EN" "http://www.w3.org/TR/Html1/DTD/strict.dtd"><html><head><title>Inhalersmodel</title></head><body><p><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;model <br>&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;#<br>&nbsp;&nbsp;&nbsp;# Construct individual response data from contingency table<br>&nbsp;&nbsp;&nbsp;#<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for (i in 1 : Ncum[1, 1]) { <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;group[i] &lt;- 1<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for (t in 1 : T) { response[i, t] &lt;- pattern[1, t] }<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for (i in (Ncum[1,1] + 1) : Ncum[1, 2]) { <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;group[i] &lt;- 2 for (t in 1 : T) { response[i, t] &lt;- pattern[1, t] }<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for (k in 2 : Npattern) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for(i in (Ncum[k - 1, 2] + 1) : Ncum[k, 1]) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;group[i] &lt;- 1 for (t in 1 : T) { response[i, t] &lt;- pattern[k, t] }<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for(i in (Ncum[k, 1] + 1) : Ncum[k, 2]) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;group[i] &lt;- 2 for (t in 1 : T) { response[i, t] &lt;- pattern[k, t] }<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;#<br>&nbsp;&nbsp;&nbsp;# Model<br>&nbsp;&nbsp;&nbsp;#<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for (i in 1 : N) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for (t in 1 : T) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for (j in 1 : Ncut) {<br>&nbsp;&nbsp;&nbsp;# <br>&nbsp;&nbsp;&nbsp;# Cumulative probability of worse response than j<br>&nbsp;&nbsp;&nbsp;#<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logit(Q[i, t, j]) &lt;- -(a[j] + mu[group[i], t] + b[i])<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;#<br>&nbsp;&nbsp;&nbsp;# Probability of response = j<br>&nbsp;&nbsp;&nbsp;#<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p[i, t, 1] &lt;- 1 - Q[i, t, 1]<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for (j in 2 : Ncut) { p[i, t, j] &lt;- Q[i, t, j - 1] - Q[i, t, j] }<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p[i, t, (Ncut+1)] &lt;- Q[i, t, Ncut]<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;response[i, t] ~ dcat(p[i, t, ])<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;#<br>&nbsp;&nbsp;&nbsp;# Subject (random) effects<br>&nbsp;&nbsp;&nbsp;#<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b[i] ~ dnorm(0.0, tau)<br>&nbsp;&nbsp;&nbsp;}<br><br>&nbsp;&nbsp;&nbsp;#<br>&nbsp;&nbsp;&nbsp;# Fixed effects<br>&nbsp;&nbsp;&nbsp;#<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for (g in 1 : G) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for(t in 1 : T) { <br>&nbsp;&nbsp;&nbsp;# logistic mean for group i in period t<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mu[g, t] &lt;- beta * treat[g, t] / 2 + pi * period[g, t] / 2 + kappa * carry[g, t] <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;beta ~ dnorm(0, 1.0E-06)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pi ~ dnorm(0, 1.0E-06)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;kappa ~ dnorm(0, 1.0E-06)<br><br>&nbsp;&nbsp;&nbsp;# ordered cut points for underlying continuous latent variable <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a[1] ~ dflat()T(-1000, a[2])<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a[2] ~ dflat()T(a[1], a[3])<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a[3] ~ dflat()T(a[2], 1000) <br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tau ~ dgamma(0.001, 0.001)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sigma &lt;- sqrt(1 / tau)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;log.sigma &lt;- log(sigma)<br><br>&nbsp;&nbsp;&nbsp;}<br></font></p></body></html>