<!DOCTYPE html PUBLIC "-//W3C//DTD Html 1.0 Strict//EN" "http://www.w3.org/TR/Html1/DTD/strict.dtd"><html><head><title>OtreesMVN</title></head><body><p><font face="Arial" color="#000100" size="2"></font><font face="Arial" color="#000100" size="3"><strong><img src="otreesmvn0.bmp" alt="[otreesmvn0]"></strong></font><font face="Arial" color="#0000FF" size="5"><strong>&nbsp;&nbsp;&nbsp;</strong></font><font face="Courier New" color="#000100" size="6">Orange Trees: Non-linear growth<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;curve</font><font face="Arial" color="#000000" size="5"><br><br></font><font face="Arial" color="#000000" size="3">We repeat the Otrees example, replacing the 3 independent univariate Normal priors for each </font><font face="Symbol" color="#000100" size="3">f</font><font face="Symbol" color="#000100" size="2"> </font><font face="Arial" color="#000000" size="2"><sub>ik</sub></font><font face="Arial" color="#000000" size="3">, k=1,2,3 by a multivariate Normal prior </font><font face="Symbol" color="#000100" size="3"><strong>f</strong></font><font face="Symbol" color="#000100" size="3"> </font><font face="Arial" color="#000000" size="2"><sub>i</sub></font><font face="Arial" color="#000000" size="3"><sub> </sub></font><font face="Arial" color="#000000" size="3">~ MNV(</font><font face="Symbol" color="#000100" size="3"><strong>m</strong></font><font face="Arial" color="#000000" size="3">, </font><font face="Symbol" color="#000100" size="3"><strong>T</strong></font><font face="Arial" color="#000000" size="3">)<br></font><font face="Arial" color="#FF8000" size="3"><br></font><font face="Arial" color="#000000" size="3">&nbsp;&nbsp;&nbsp;model {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for (i in 1:K) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for (j in 1:n) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Y[i, j] ~ dnorm(eta[i, j], tauC)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;eta[i, j] &lt;- phi[i, 1] / (1 + phi[i, 2] * exp(phi[i, 3] * x[j]))<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;phi[i, 1] &lt;- exp(theta[i, 1])<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;phi[i, 2] &lt;- exp(theta[i, 2]) - 1<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;phi[i, 3] &lt;- -exp(theta[i, 3])<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;theta[i, 1:3] ~ dmnorm(mu[1:3], tau[1:3, 1:3])<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mu[1:3] ~ dmnorm(mean[1:3], prec[1:3, 1:3])<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tau[1:3, 1:3] ~ dwish(R[1:3, 1:3], 3)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sigma2[1:3, 1:3] &lt;- inverse(tau[1:3, 1:3]) <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for (i in 1 : 3) {sigma[i] &lt;- sqrt(sigma2[i, i]) }<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tauC ~ dgamma(1.0E-3, 1.0E-3)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sigmaC &lt;- 1 / sqrt(tauC)<br>&nbsp;&nbsp;&nbsp;}<br><br></font><font face="Arial" color="#000000" size="3"><br></font><font face="Arial" color="#0000FF" size="5"><a href="../Examples/OtreesMVNdata.html"></font><font face="Arial" color="#0000FF" size="5"><u>Data</u></font><font face="Arial" color="#0000FF" size="5"></a></font><font face="Arial" color="#000000" size="3"> ( click to open )</font><font face="Arial" color="#000100" size="3"><br></font><font face="Arial" color="#0000FF" size="5"><br><a href="../Examples/OtreesMVNinits.html"></font><font face="Arial" color="#0000FF" size="5"><u>Inits&nbsp;for&nbsp;chain&nbsp;1</a></u></font><font face="Arial" color="#000000" size="3"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#0000FF" size="5"><a href="../Examples/OtreesMVNinits1.html"></font><font face="Arial" color="#0000FF" size="5"><u>Inits&nbsp;for&nbsp;chain&nbsp;2</a></u></font><font face="Arial" color="#000000" size="3">&nbsp;&nbsp;&nbsp;( click to open )</font><font face="Arial" color="#0000FF" size="5"><br></font><font face="Arial" color="#000100" size="3"><br><br></font><font face="Arial" color="#0000FF" size="5">Results</font><font face="Arial" color="#000100" size="5"> <br></font><font face="Arial" color="#000100" size="3"><br></font><font face="Arial" color="#000000" size="3">A 4000 iteration Metropolis adaptive phase plus 1000 update burn in followed by a further 10000 updates gave the parameter estimates:<br><center><br><img src="otreesmvn1.bmp" alt="[otreesmvn1]"></font></center></p></body></html>