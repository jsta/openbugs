<!DOCTYPE html PUBLIC "-//W3C//DTD Html 1.0 Strict//EN" "http://www.w3.org/TR/Html1/DTD/strict.dtd"><html><head><title>Biopsies</title></head><body><p><font face="Arial" color="#000100" size="2"></font><font face="Arial" color="#000100" size="3"><strong><img src="biopsies0.bmp" alt="[biopsies0]"></strong></font><font face="Arial" color="#0000FF" size="5"><strong>&nbsp;&nbsp;&nbsp;</strong></font><font face="Courier New" color="#000100" size="6">Biopsies: discrete variable<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;latent class model</font><font face="Arial" color="#0000FF" size="5"><strong><br></strong></font><font face="Arial" color="#0000FF" size="3"><strong><br></strong></font><font face="Arial" color="#000100" size="3">Spiegelhalter and Stovin (1983) presented data on repeated biopsies of transplanted hearts, in which a total of 414 biopsies had been taken at 157 sessions. Each biopsy was graded on evidence of rejection using a 4 category scale of none (O), minimal (M), mild (+) and moderate-severe (++). Part of the data is shown below.<br><center><br></font><font face="Arial" color="#000100" size="2"><img src="biopsies1.bmp" alt="[biopsies1]"><br></center></font><font face="Arial" color="#000100" size="3">The sampling procedure may not detect the area of maximum rejection, which is considered the true underlying state at the time of the session and denoted t</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> --- the underlying probability distribution of the four true states is denoted by the vector p. It is then assumed that each of the observed biopsies are conditionally independent given this truestate with the restriction that there are no`false positives': i.e. one cannot observe a biopsy worse than the true state. We then have the sampling model&nbsp;&nbsp;&nbsp;<br><br>&nbsp;&nbsp;&nbsp;b</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> ~ Multinomial(e</font><font face="Arial" color="#000100" size="2"><sub>t</sub></font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3">, n</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3">)<br><br>&nbsp;&nbsp;&nbsp;t</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> ~ Categorical(p)<br><br><br>where b</font><font face="Arial" color="#000100" size="3"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> denotes the multinomial response at session </font><font face="Arial" color="#000100" size="3"><em>i</em></font><font face="Arial" color="#000100" size="3"> where n</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> biopsies have been taken, and e</font><font face="Arial" color="#000100" size="3"><sub>jk</sub></font><font face="Arial" color="#000100" size="3"> is the probability that a true state t</font><font face="Arial" color="#000100" size="3"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> = j generates a biopsy in state k.The no-false-positive restriction means that e</font><font face="Arial" color="#000100" size="2"><sub>12</sub></font><font face="Arial" color="#000100" size="3"> = e</font><font face="Arial" color="#000100" size="2"><sub>13</sub></font><font face="Arial" color="#000100" size="3"> = e</font><font face="Arial" color="#000100" size="2"><sub>14</sub></font><font face="Arial" color="#000100" size="3"> = e</font><font face="Arial" color="#000100" size="2"><sub>23</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">= e</font><font face="Arial" color="#000100" size="2"><sub>24</sub></font><font face="Arial" color="#000100" size="3"> = e</font><font face="Arial" color="#000100" size="2"><sub>34</sub></font><font face="Arial" color="#000100" size="3"> = 0. Spiegelhalter and Stovin (1983) estimated the parameters e</font><font face="Arial" color="#000100" size="2"><sub>j</sub></font><font face="Arial" color="#000100" size="3"> and p using the EM algorithm, with some smoothing to avoid zero estimates.<br><br>The appropriate graph is shown below, where the role of the true state t</font><font face="Arial" color="#000100" size="3"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> is simply to pick the appropriate row from the 4 x 4 error matrix e. Here the probability vectors e</font><font face="Arial" color="#000100" size="2">j</font><font face="Arial" color="#000100" size="3"> (j = 1,...,4) and p are assumed to have uniform priors on the unit simplex, which correspond to Dirichlet priors with all parameters being 1.<br><br>The BUGS code for this model is given below. No initial values are provided for the latent states, since the forward sampling procedure will find a configuration of starting values that is compatible with the expressed constraints. We also note the apparent ``cycle'' in the graph created by the expression nbiops[i] &lt;- sum(biopsies[i,]). This will lead Such ``cycles'' are permitted provided that they are only data transformation statements, since this does not affect the essential probability model. <br></font><font face="Arial" color="#000100" size="3"><br><br></font><font face="Arial" color="#000100" size="2"></font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">model<br></font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">{<br></font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">for (i in 1 : ns){<br></font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">nbiops[i] &lt;- sum(biopsies[i, ]) <br></font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">true[i] ~ dcat(p[])<br></font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">biopsies[i, 1 : 4] ~ dmulti(error[true[i], ], nbiops[i])<br></font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">}<br></font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">error[2,1 : 2] ~ ddirich(prior[1 : 2])<br></font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">error[3,1 : 3] ~ ddirich(prior[1 : 3])<br></font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">error[4,1 : 4] ~ ddirich(prior[1 : 4])<br></font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">p[1 : 4] ~ ddirich(prior[]); # prior for p<br></font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">}<br><br></font><font face="Arial" color="#000000" size="2"></font><font face="Arial" color="#000100" size="1"><br></font><font face="Arial" color="#0000FF" size="5"><u><a href="../Examples/Biopsiesdata.html">Data</u></font><font face="Arial" color="#0000FF" size="5"></a></font><font face="Arial" color="#000100" size="3"> ( click to open )</font><font face="Arial" color="#000000" size="2"><br><br></font><font face="Arial" color="#0000FF" size="5"><u><a href="../Examples/Biopsiesinits.html">Inits&nbsp;for&nbsp;chain&nbsp;1</a></u></font><font face="Arial" color="#000100" size="3"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#0000FF" size="5"><u><a href="../Examples/Biopsiesinits1.html">Inits&nbsp;for&nbsp;chain&nbsp;2</a>&nbsp;&nbsp;&nbsp;</u></font><font face="Arial" color="#000100" size="3">( click to open )</font><font face="Arial" color="#000000" size="2"><br><br></font><font face="Arial" color="#0000FF" size="5">Results </font><font face="Arial" color="#000000" size="2"><br></font><font face="Arial" color="#000000" size="3"><br>A 1000 update burn in followed by a further 10000 updates gave the parameter estimates<br><center><br><img src="biopsies2.bmp" alt="[biopsies2]"></font><font face="Arial" color="#000000" size="2"><br></font></center></p></body></html>