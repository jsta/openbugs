<!DOCTYPE html PUBLIC "-//W3C//DTD Html 1.0 Strict//EN" "http://www.w3.org/TR/Html1/DTD/strict.dtd"><html><head><title>Salm</title></head><body><p><font face="Arial" color="#000100" size="2"></font><font face="Arial" color="#000100" size="3"><strong><img src="salm0.bmp" alt="[salm0]"></strong></font><font face="Arial" color="#0000FF" size="5"><strong>&nbsp;&nbsp;&nbsp;</strong></font><font face="Courier New" color="#000100" size="6">Salm: extra - Poisson variation<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;in dose - response study</font><font face="Arial" color="#0000FF" size="5"><strong><br></strong></font><font face="Arial" color="#000100" size="3"><br>Breslow (1984) analyses some mutagenicity assay data (shown below) on salmonella in which three plates have been processed at each dose </font><font face="Arial" color="#000100" size="3"><em>i</em></font><font face="Arial" color="#000100" size="3"> of quinoline and the number of revertant colonies of TA98 Salmonella measured. A certain dose-response curve is suggested by theory.<br></font><font face="Arial" color="#000100" size="2"><br><img src="salm1.bmp" alt="[salm1]"></font><font face="Arial" color="#000100" size="3"><br>This is assumed to be a random effects Poisson model allowing for over-dispersion. Let x</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> be the dose on the plates </font><font face="Arial" color="#000100" size="3"><em>i</em></font><font face="Arial" color="#000100" size="3">1, </font><font face="Arial" color="#000100" size="3"><em>i</em></font><font face="Arial" color="#000100" size="3">2 and </font><font face="Arial" color="#000100" size="3"><em>i</em></font><font face="Arial" color="#000100" size="3">3. Then we assume<br><br>&nbsp;&nbsp;&nbsp;y</font><font face="Arial" color="#000100" size="2"><sub>ij</sub></font><font face="Arial" color="#000100" size="3"> ~ Poisson(</font><font face="Symbol" color="#000100" size="3">m</font><font face="Arial" color="#000100" size="2"><sub>ij</sub></font><font face="Arial" color="#000100" size="3">)<br><br>&nbsp;&nbsp;&nbsp;log(</font><font face="Symbol" color="#000100" size="3">m</font><font face="Arial" color="#000100" size="2"><sub>ij</sub></font><font face="Arial" color="#000100" size="3">) = </font><font face="Symbol" color="#000100" size="3">a</font><font face="Arial" color="#000100" size="3"> + </font><font face="Symbol" color="#000100" size="3">b </font><font face="Arial" color="#000100" size="3">log(x</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> + 10) + </font><font face="Symbol" color="#000100" size="3">g</font><font face="Arial" color="#000100" size="3">x</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> + </font><font face="Symbol" color="#000100" size="3">l</font><font face="Arial" color="#000100" size="2"><sub>ij</sub></font><font face="Arial" color="#000100" size="3"><br><br>&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3">l</font><font face="Arial" color="#000100" size="2"><sub>ij</sub></font><font face="Arial" color="#000100" size="3"> ~ Normal(0,</font><font face="Symbol" color="#000100" size="3"> t</font><font face="Arial" color="#000100" size="3">)<br><br></font><font face="Symbol" color="#000100" size="3">a , b , g , t </font><font face="Arial" color="#000100" size="3">are given independent ``noninformative'' priors. The appropriate graph is shown<br></font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#0000FF" size="5"><strong><center><br></strong></font><font face="Arial" color="#000100" size="3"><em>Graphical model for salm example</em></font><font face="Arial" color="#000100" size="2"><br><img src="salm2.bmp" alt="[salm2]"><br><br></font><font face="Arial" color="#000100" size="3"><br><br></font><font face="Arial" color="#000100" size="3">BUGS</font><font face="Arial" color="#000100" size="3"><em> language for salm example<br></em></font><font face="Arial" color="#000100" size="3"><br></font><font face="Arial" color="#000100" size="2"></center></font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;model<br>&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for( i in 1 : doses ) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for( j in 1 : plates ) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y[i , j] ~ dpois(mu[i , j])<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;log(mu[i , j]) &lt;- alpha + beta * log(x[i] + 10) + <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gamma * x[i] + lambda[i , j]<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lambda[i , j] ~ dnorm(0.0, tau)&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cumulative.y[i , j] &lt;- cumulative(y[i , j], y[i , j])<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;alpha ~ dnorm(0.0,1.0E-6)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;beta ~ dnorm(0.0,1.0E-6)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gamma ~ dnorm(0.0,1.0E-6)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tau ~ dgamma(0.001, 0.001)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sigma &lt;- 1 / sqrt(tau)<br>&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3"><br></font><font face="Arial" color="#0000FF" size="5"><a href="../Examples/Salmdata.html"></font><font face="Arial" color="#0000FF" size="5"><u>Data</u></font><font face="Arial" color="#0000FF" size="5"></a></font><font face="Arial" color="#000000" size="3"> ( click to open )</font><font face="Arial" color="#000100" size="3"><br></font><font face="Arial" color="#0000FF" size="5"><br><a href="../Examples/Salminits.html"></font><font face="Arial" color="#0000FF" size="5"><u>Inits&nbsp;for&nbsp;chain&nbsp;1</a>&nbsp;&nbsp;&nbsp;</u></font><font face="Arial" color="#000000" size="3"></font><font face="Arial" color="#0000FF" size="5"><a href="../Examples/Salminits1.html"></font><font face="Arial" color="#0000FF" size="5"><u>Inits&nbsp;for&nbsp;chain&nbsp;2</a></u></font><font face="Arial" color="#000000" size="3">&nbsp;&nbsp;&nbsp;( click to open )</font><font face="Arial" color="#0000FF" size="5"><br></font><font face="Arial" color="#000100" size="3"><br></font><font face="Arial" color="#000100" size="2"><br><br></font><font face="Arial" color="#0000FF" size="5">Results</font><font face="Arial" color="#000000" size="2"><br></font><font face="Arial" color="#000000" size="3"><br>A 1000 update burn in followed by a further 10000 updates gave the parameter estimates<br><center><br><img src="salm3.bmp" alt="[salm3]"><br></font><font face="Arial" color="#000100" size="2"><br></center></font><font face="Arial" color="#000100" size="3">These estimates can be compared with the quasi-likelihood estimates of Breslow (1984) who reported </font><font face="Symbol" color="#000100" size="3">a</font><font face="Arial" color="#000100" size="3"> = 2.203 +/- 0.363, </font><font face="Symbol" color="#000100" size="3">b</font><font face="Arial" color="#000100" size="3"> = 0.311 +/- 0.099, </font><font face="Symbol" color="#000100" size="3">g</font><font face="Arial" color="#000100" size="3"> = -9.74E-4 +/- 4.37E-4, </font><font face="Symbol" color="#000100" size="3">s</font><font face="Arial" color="#000100" size="3"> = 0.268</font></p></body></html>