<!DOCTYPE html PUBLIC "-//W3C//DTD Html 1.0 Strict//EN" "http://www.w3.org/TR/Html1/DTD/strict.dtd"><html><head><title>Dyes</title></head><body><p><font face="Arial" color="#000100" size="1"></font><font face="Arial" color="#000100" size="3"><strong><img src="dyes0.bmp" alt="[dyes0]"></strong></font><font face="Arial" color="#0000FF" size="5"><strong>&nbsp;&nbsp;&nbsp;</strong></font><font face="Courier New" color="#000100" size="6">Dyes: variance components model</font><font face="Arial" color="#0000FF" size="5"><strong><br></strong></font><font face="Arial" color="#000100" size="3"><br>Box and Tiao (1973) analyse data first presented by Davies (1967) concerning batch to batch variation in yields of dyestuff. The data (shown below) arise from a balanced experiment whereby the total product yield was determined for 5 samples from each of 6 randomly chosen batches of raw material.<br><center><br></font><font face="Arial" color="#000100" size="2"><img src="dyes1.bmp" alt="[dyes1]"></center><br></font><font face="Arial" color="#000100" size="3">The object of the study was to determine the relative importance of between batch variation versus variation due to sampling and analytic errors. On the assumption that the batches and samples vary independently, and contribute additively to the total error variance, we may assume the following model for dyestuff yield:<br><br></font><font face="Arial" color="#000100" size="2">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">y</font><font face="Arial" color="#000100" size="1"><sub>ij</sub></font><font face="Arial" color="#000100" size="3"> ~ Normal(</font><font face="Symbol" color="#000100" size="3">m</font><font face="Arial" color="#000100" size="1"><sub>i</sub></font><font face="Arial" color="#000100" size="3">, </font><font face="Symbol" color="#000100" size="3">t</font><font face="Arial" color="#000100" size="1"><sub>within</sub></font><font face="Arial" color="#000100" size="3">)<br>&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3">m</font><font face="Arial" color="#000100" size="1"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> ~ Normal(</font><font face="Symbol" color="#000100" size="3">q</font><font face="Arial" color="#000100" size="3">,</font><font face="Symbol" color="#000100" size="3"> t</font><font face="Arial" color="#000100" size="1"><sub>between</sub></font><font face="Arial" color="#000100" size="3">)<br>&nbsp;&nbsp;&nbsp;<br>where y</font><font face="Arial" color="#000100" size="2"><sub>ij</sub></font><font face="Arial" color="#000100" size="3"> is the yield for sample </font><font face="Arial" color="#000100" size="3"><em>j</em></font><font face="Arial" color="#000100" size="3"> of batch </font><font face="Arial" color="#000100" size="3"><em>i</em></font><font face="Arial" color="#000100" size="3">, </font><font face="Symbol" color="#000100" size="3">m</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> is the true yield for batch </font><font face="Arial" color="#000100" size="3"><em>i</em></font><font face="Arial" color="#000100" size="3">, </font><font face="Symbol" color="#000100" size="3">t</font><font face="Arial" color="#000100" size="2"><sub>within</sub></font><font face="Arial" color="#000100" size="3"> is the inverse of the within-batch variance </font><font face="Symbol" color="#000100" size="3">s</font><font face="Arial" color="#000100" size="2"><sup>2</sup></font><font face="Arial" color="#000100" size="2"><sub>within</sub></font><font face="Arial" color="#000100" size="3"> ( </font><font face="Arial" color="#000100" size="3"><em>i.e.</em></font><font face="Arial" color="#000100" size="3"> the variation due to sampling and analytic error), </font><font face="Symbol" color="#000100" size="3">q</font><font face="Arial" color="#000100" size="3"> is the true average yield for all batches and </font><font face="Symbol" color="#000100" size="3">t</font><font face="Arial" color="#000100" size="2"><sub>between</sub></font><font face="Arial" color="#000100" size="3"> is the inverse of the between-batch variance s</font><font face="Arial" color="#000100" size="2"><sup>2</sup></font><font face="Arial" color="#000100" size="2"><sub>between</sub></font><font face="Arial" color="#000100" size="3">. The total variation in product yield is thus </font><font face="Symbol" color="#000100" size="3">s</font><font face="Arial" color="#000100" size="2"><sup>2</sup></font><font face="Arial" color="#000100" size="2"><sub>total</sub></font><font face="Arial" color="#000100" size="3"> = </font><font face="Symbol" color="#000100" size="3">s</font><font face="Arial" color="#000100" size="2"><sup>2</sup></font><font face="Arial" color="#000100" size="2"><sub>within</sub></font><font face="Arial" color="#000100" size="3"> + </font><font face="Symbol" color="#000100" size="3">s</font><font face="Arial" color="#000100" size="2"><sup>2</sup></font><font face="Arial" color="#000100" size="2"><sub>between</sub></font><font face="Arial" color="#000100" size="3"> and the relative contributions of each component to the total variance are f</font><font face="Arial" color="#000100" size="2"><sub>within</sub></font><font face="Arial" color="#000100" size="3"> = </font><font face="Symbol" color="#000100" size="3">s</font><font face="Arial" color="#000100" size="2"><sup>2</sup></font><font face="Arial" color="#000100" size="2"><sub>within</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">/ </font><font face="Symbol" color="#000100" size="3">s</font><font face="Arial" color="#000100" size="2"><sup>2</sup></font><font face="Arial" color="#000100" size="2"><sub>total</sub></font><font face="Arial" color="#000100" size="3"> and f</font><font face="Arial" color="#000100" size="2"><sub>between</sub></font><font face="Arial" color="#000100" size="3"> = </font><font face="Symbol" color="#000100" size="3">s</font><font face="Arial" color="#000100" size="2"><sup>2</sup></font><font face="Arial" color="#000100" size="2"><sub>between</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">/ </font><font face="Symbol" color="#000100" size="3">s</font><font face="Arial" color="#000100" size="3"><sup>2</sup></font><font face="Arial" color="#000100" size="2"><sub>total</sub></font><font face="Arial" color="#000100" size="3"> . We assume standard non-informative priors for </font><font face="Symbol" color="#000100" size="3">q</font><font face="Arial" color="#000100" size="3">, </font><font face="Symbol" color="#000100" size="3">t</font><font face="Arial" color="#000100" size="2"><sub>within</sub></font><font face="Arial" color="#000100" size="3"> and </font><font face="Symbol" color="#000100" size="3">t</font><font face="Arial" color="#000100" size="2"><sub>between</sub></font><font face="Arial" color="#000100" size="3">.<br><br></font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#0000FF" size="5"><strong><center></strong></font><font face="Arial" color="#000100" size="3"><em>Graphical model for dyes example</em></font><font face="Arial" color="#0000FF" size="5"><strong><br><img src="dyes2.bmp" alt="[dyes2]"></strong></font><font face="Arial" color="#000100" size="5"><strong><br><br><br></strong></font><font face="Arial" color="#000100" size="3"><em>Bugs</em></font><font face="Arial" color="#000100" size="3"> language for dyes example<br></font><font face="Arial" color="#000100" size="5"><strong></center></strong></font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;model<br>&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for(i in 1 : batches) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mu[i] ~ dnorm(theta, tau.btw)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for(j in 1 : samples) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y[i , j] ~ dnorm(mu[i], tau.with)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cumulative.y[i , j] &lt;- cumulative(y[i , j], y[i , j])<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sigma2.with &lt;- 1 / tau.with<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sigma2.btw &lt;- 1 / tau.btw<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tau.with ~ dgamma(0.001, 0.001)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tau.btw ~ dgamma(0.001, 0.001)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;theta ~ dnorm(0.0, 1.0E-10)<br>&nbsp;&nbsp;&nbsp;}<br></font><font face="Arial" color="#000100" size="1"><br></font><font face="Arial" color="#0000FF" size="5"><a href="../Examples/Dyesdata.html"></font><font face="Arial" color="#0000FF" size="5"><u>Data</u></font><font face="Arial" color="#0000FF" size="5"></a></font><font face="Arial" color="#000100" size="3"> ( click to open )</font><font face="Arial" color="#000000" size="2"><br><br></font><font face="Arial" color="#0000FF" size="5"><a href="../Examples/Dyesinits.html"></font><font face="Arial" color="#0000FF" size="5"><u>Inits&nbsp;for&nbsp;chain&nbsp;1</a></u></font><font face="Arial" color="#000100" size="3"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#0000FF" size="5"><a href="../Examples/Dyesinits1.html"></font><font face="Arial" color="#0000FF" size="5"><u>Inits&nbsp;for&nbsp;chain&nbsp;2</a></u></font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;( click to open )</font><font face="Arial" color="#000000" size="2"><br></font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#0000FF" size="5">Results</font><font face="Arial" color="#000000" size="2"><br></font><font face="Arial" color="#000000" size="3"><br>A 25000 update burn in followed by a further 100000 updates gave the parameter estimates<br><center></font><font face="Arial" color="#000100" size="3"><br><img src="dyes3.bmp" alt="[dyes3]"><br></font><font face="Arial" color="#000100" size="3"><br>Note that a relatively long run was required because of the high autocorrelation between successively sampled values of some parameters. Such correlations reduce the 'effective' size of the posterior sample, and hence a longer run is needed to ensure sufficient precision of the posterior estimates. Note that the posterior distribution for </font><font face="Symbol" color="#000100" size="3">s</font><font face="Arial" color="#000100" size="3"><sup>2</sup></font><font face="Arial" color="#000100" size="3"><sub>between</sub></font><font face="Arial" color="#000100" size="3"> has a very long upper tail: hence the posterior mean is considerably larger than the median. Box and Tiao estimate </font><font face="Symbol" color="#000100" size="3">s</font><font face="Arial" color="#000100" size="3"><sup>2</sup></font><font face="Arial" color="#000100" size="2"><sub>within</sub></font><font face="Arial" color="#000100" size="3"> = 2451 and </font><font face="Symbol" color="#000100" size="3">s</font><font face="Arial" color="#000100" size="3"><sup>2</sup></font><font face="Arial" color="#000100" size="2"><sub>between</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">= 1764 by classical analysis of variance. Here, </font><font face="Symbol" color="#000100" size="3">s</font><font face="Arial" color="#000100" size="3"><sup>2</sup></font><font face="Arial" color="#000100" size="2"><sub>between</sub></font><font face="Arial" color="#000100" size="3"> is estimated by the difference of the between- and within-batch mean squares divided by the number of batches - 1. In cases where the between-batch mean square within-batch mean square, this leads to the unsatisfactory situation of a </font><font face="Arial" color="#000100" size="3"><em>negative</em></font><font face="Arial" color="#000100" size="3"> variance estimate. Computing a confidence interval for </font><font face="Symbol" color="#000100" size="3">s</font><font face="Arial" color="#000100" size="3"><sup>2</sup></font><font face="Arial" color="#000100" size="2"><sub>between</sub></font><font face="Arial" color="#000100" size="3"> is also difficult using the classical approach due to its complicated sampling distribution<br></font><font face="Arial" color="#000100" size="2"><br></font></center></p></body></html>