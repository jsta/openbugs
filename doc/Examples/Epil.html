<!DOCTYPE html PUBLIC "-//W3C//DTD Html 1.0 Strict//EN" "http://www.w3.org/TR/Html1/DTD/strict.dtd"><html><head><title>Epil</title></head><body><p><font face="Arial" color="#000100" size="2"></font><font face="Arial" color="#000100" size="3"><strong><img src="epil0.bmp" alt="[epil0]"></strong></font><font face="Arial" color="#0000FF" size="5"><strong>&nbsp;&nbsp;&nbsp;</strong></font><font face="Courier New" color="#000100" size="6">Epilepsy: repeated measures on<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Poisson counts</font><font face="Arial" color="#0000FF" size="5"><br></font><font face="Arial" color="#000100" size="3"><br></font><font face="Arial" color="#000100" size="3">Breslow and Clayton (1993) analyse data initially provided by Thall and Vail (1990) concerning seizure counts in a randomised trial of anti-convulsant therpay in epilepsy. The table below shows the successive seizure counts for 59 patients. Covariates are treatment (0,1), 8-week baseline seizure counts, and age in years. The structure of this data is shown below<br><center><br></font><font face="Arial" color="#000100" size="2"><img src="epil1.bmp" alt="[epil1]"></center></font><font face="Arial" color="#000100" size="3"><br>We consider model </font><font face="Arial" color="#000100" size="3"><em>III</em></font><font face="Arial" color="#000100" size="3"> of Breslow and Clayton (1993), in which Base is transformed to log(Base/4) and Age to log(Age), and a Treatment by log(Base/4) interaction is included. Also present are random effects for both individual subjects b</font><font face="Arial" color="#000100" size="2">1</font><font face="Arial" color="#000100" size="2"><sub>j</sub></font><font face="Arial" color="#000100" size="3"> and also subject by visit random effects b</font><font face="Arial" color="#000100" size="2"><sub>jk</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">to model extra-Poisson variability within subjects. V</font><font face="Arial" color="#000100" size="2">4</font><font face="Arial" color="#000100" size="3"> is an indicator variable for the 4th visit.<br><br>&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;y</font><font face="Arial" color="#000100" size="2"><sub>jk</sub></font><font face="Arial" color="#000100" size="3"> ~ Poisson(</font><font face="Symbol" color="#000100" size="3">m</font><font face="Arial" color="#000100" size="2"><sub>jk</sub></font><font face="Arial" color="#000100" size="3">)<br>&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;log</font><font face="Symbol" color="#000100" size="3">m</font><font face="Arial" color="#000100" size="2"><sub>jk</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">= </font><font face="Symbol" color="#000100" size="3">a</font><font face="Arial" color="#000100" size="2"><sub>0</sub></font><font face="Arial" color="#000100" size="3"> + </font><font face="Symbol" color="#000100" size="3">a</font><font face="Arial" color="#000100" size="2"><sub>Base</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">log(Base</font><font face="Arial" color="#000100" size="2"><sub>j</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">/ 4) + </font><font face="Symbol" color="#000100" size="3">a</font><font face="Arial" color="#000100" size="2"><sub>Trt</sub></font><font face="Arial" color="#000100" size="3">Trt</font><font face="Arial" color="#000100" size="2"><sub>j</sub></font><font face="Arial" color="#000100" size="3"> + </font><font face="Symbol" color="#000100" size="3">a</font><font face="Arial" color="#000100" size="2"><sub>BT</sub></font><font face="Arial" color="#000100" size="3">Trt</font><font face="Arial" color="#000100" size="2"><sub>j</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">log(Base</font><font face="Arial" color="#000100" size="2"><sub>j</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">/ 4) +<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3">a</font><font face="Arial" color="#000100" size="2"><sub>Age</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">Age</font><font face="Arial" color="#000100" size="2"><sub>j</sub></font><font face="Arial" color="#000100" size="3"> + </font><font face="Symbol" color="#000100" size="3">a</font><font face="Arial" color="#000100" size="2"><sub>V4</sub></font><font face="Arial" color="#000100" size="3">V</font><font face="Arial" color="#000100" size="2"><sub>4</sub></font><font face="Arial" color="#000100" size="3"> + b1</font><font face="Arial" color="#000100" size="2"><sub>j</sub></font><font face="Arial" color="#000100" size="3"> + b</font><font face="Arial" color="#000100" size="2"><sub>jk</sub></font><font face="Arial" color="#000100" size="3"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;b1</font><font face="Arial" color="#000100" size="2"><sub>j</sub></font><font face="Arial" color="#000100" size="3"> ~ Normal(0,</font><font face="Symbol" color="#000100" size="3"> t</font><font face="Arial" color="#000100" size="2"><sub>b1</sub></font><font face="Arial" color="#000100" size="3">)<br>&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;b</font><font face="Arial" color="#000100" size="2"><sub>jk</sub></font><font face="Arial" color="#000100" size="3"> ~ Normal(0, </font><font face="Symbol" color="#000100" size="3">t</font><font face="Arial" color="#000100" size="2"><sub>b</sub></font><font face="Arial" color="#000100" size="3">)<br><br>Coefficients and precisions are given independent &quot;noninformative'' priors. <br><br>The graphical model is below<br><center></font><font face="Arial" color="#000100" size="2"><br><img src="epil2.bmp" alt="[epil2]"><br></center><br></font><font face="Arial" color="#000100" size="3">The model shown above leads to a Markov chain that is highly correlated with poor convergence properties. This can be overcome by standardizing each covariate about its mean to ensure approximate prior independence between the regression coefficients as show below:<br><center></font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="3">BUGS</font><font face="Arial" color="#000100" size="3"><em> language for epil example model III with covariate centering<br>(centering interaction term BT about mean(BT)):</em></font><font face="Arial" color="#000100" size="3"><br><br></font><font face="Arial" color="#000100" size="2"><br></center></font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;model <br>&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for(j in 1 : N) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for(k in 1 : T) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;log(mu[j, k]) &lt;- a0 + alpha.Base * (log.Base4[j] - log.Base4.bar) <br>&nbsp;&nbsp;&nbsp;+ alpha.Trt * (Trt[j] - Trt.bar) <br>&nbsp;&nbsp;&nbsp;+ alpha.BT * (BT[j] - BT.bar) <br>&nbsp;&nbsp;&nbsp;+ alpha.Age * (log.Age[j] - log.Age.bar) <br>&nbsp;&nbsp;&nbsp;+ alpha.V4 * (V4[k] - V4.bar) <br>&nbsp;&nbsp;&nbsp;+ b1[j] + b[j, k]<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y[j, k] ~ dpois(mu[j, k])<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b[j, k] ~ dnorm(0.0, tau.b); # subject*visit random effects<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b1[j] ~ dnorm(0.0, tau.b1) # subject random effects<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BT[j] &lt;- Trt[j] * log.Base4[j] # interaction<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;log.Base4[j] &lt;- log(Base[j] / 4) log.Age[j] &lt;- log(Age[j])<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;# covariate means:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;log.Age.bar &lt;- mean(log.Age[]) <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Trt.bar &lt;- mean(Trt[]) <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BT.bar &lt;- mean(BT[]) <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;log.Base4.bar &lt;- mean(log.Base4[]) <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;V4.bar &lt;- mean(V4[]) <br>&nbsp;&nbsp;&nbsp;# priors:<br>&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a0 ~ dnorm(0.0,1.0E-4) &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;alpha.Base ~ dnorm(0.0,1.0E-4) <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;alpha.Trt ~ dnorm(0.0,1.0E-4); <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;alpha.BT ~ dnorm(0.0,1.0E-4) <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;alpha.Age ~ dnorm(0.0,1.0E-4) <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;alpha.V4 ~ dnorm(0.0,1.0E-4)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tau.b1 ~ dgamma(1.0E-3,1.0E-3); sigma.b1 &lt;- 1.0 / sqrt(tau.b1)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tau.b ~ dgamma(1.0E-3,1.0E-3); sigma.b &lt;- 1.0/ sqrt(tau.b)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;# re-calculate intercept on original scale: <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;alpha0 &lt;- a0 - alpha.Base * log.Base4.bar - alpha.Trt * Trt.bar <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- alpha.BT * BT.bar - alpha.Age * log.Age.bar - alpha.V4 * V4.bar<br>&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;<br></font><font face="Arial" color="#0000FF" size="5"><a href="../Examples/Epildata.html"></font><font face="Arial" color="#0000FF" size="5"><u>Data</u></font><font face="Arial" color="#000100" size="5"></a></font><font face="Arial" color="#000100" size="3"> ( click to open )</font><font face="Arial" color="#000100" size="1"><br><br></font><font face="Arial" color="#0000FF" size="5"><a href="../Examples/Epilinits.html"></font><font face="Arial" color="#0000FF" size="5"><u>Inits&nbsp;for&nbsp;chain&nbsp;1</a></u></font><font face="Arial" color="#000100" size="3"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#0000FF" size="5"><a href="../Examples/Epilinits1.html"></font><font face="Arial" color="#0000FF" size="5"><u>Inits&nbsp;for&nbsp;chain&nbsp;2</a>&nbsp;&nbsp;&nbsp;</u></font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;( click to open )</font><font face="Arial" color="#000100" size="1"><br><br><br></font><font face="Arial" color="#0000FF" size="5">Results</font><font face="Arial" color="#000000" size="2"><br></font><font face="Arial" color="#000000" size="3"><br>A burn in of 5000 updates followed by a further 10000 updates gave the following parameter estimates <br><center><br><img src="epil3.bmp" alt="[epil3]"><br><br>These estimates can be compared with those of Breslow and Clayton (1993) who reported<br></font><font face="Symbol" color="#000100" size="3">a</font><font face="Arial" color="#000000" size="2"><sub>0</sub></font><font face="Arial" color="#000000" size="3"> = -1.27 +/- 1.2, </font><font face="Symbol" color="#000100" size="3">a</font><font face="Arial" color="#000000" size="2"><sub>Base</sub></font><font face="Arial" color="#000000" size="3"> = 0.86 +/- 0.13, </font><font face="Symbol" color="#000100" size="3">a</font><font face="Arial" color="#000000" size="2"><sub>Trt</sub></font><font face="Arial" color="#000000" size="3"> = -0.93 +/- 0.40, </font><font face="Symbol" color="#000100" size="3">a</font><font face="Arial" color="#000000" size="2"><sub>BT</sub></font><font face="Arial" color="#000000" size="3"> = 0.34 +/- 0.21, </font><font face="Symbol" color="#000100" size="3">a</font><font face="Arial" color="#000000" size="2"><sub>Age</sub></font><font face="Arial" color="#000000" size="3"> = 0.47 +/- 0.35, </font><font face="Symbol" color="#000100" size="3">a</font><font face="Arial" color="#000000" size="2"><sub>V4</sub></font><font face="Arial" color="#000000" size="3"> = -0.10 +/- 0.90 </font><font face="Symbol" color="#000100" size="3">s</font><font face="Arial" color="#000000" size="2"><sub>b1</sub></font><font face="Arial" color="#000000" size="3"> = 0.48 +/- 0.06 </font><font face="Symbol" color="#000100" size="3">s</font><font face="Arial" color="#000000" size="2"><sub>b</sub></font><font face="Arial" color="#000000" size="3"> = 0.36+/0.04.<br><br></font><font face="Arial" color="#000100" size="3"><br></font></center></p></body></html>