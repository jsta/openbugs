<!DOCTYPE html PUBLIC "-//W3C//DTD Html 1.0 Strict//EN" "http://www.w3.org/TR/Html1/DTD/strict.dtd"><html><head><title>Hepatitis</title></head><body><p><font face="Arial" color="#000100" size="2"></font><font face="Arial" color="#0000FF" size="5"><strong><br><img src="hepatitis0.bmp" alt="[hepatitis0]">&nbsp;&nbsp;&nbsp;</strong></font><font face="Courier New" color="#000100" size="6">Hepatitis: a normal hierarchical<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;model with measurement error</font><font face="Arial" color="#0000FF" size="5"><strong><br></strong></font><font face="Arial" color="#000100" size="3"><br>This example is taken from Spiegelhalter et al (1996) (chapter in </font><font face="Arial" color="#000100" size="3"><em>Markov Chain Monte Carlo in Practice</em></font><font face="Arial" color="#000100" size="3">) and concerns 106 children whose post-vaccination anti Hb titre was measured 2 or 3 times. Both measurements and times have been transformed to a log scale. One covariate y0 = log titre at baseline, is available.<br><br>The model is essentially a random effects linear growth curve<br><br>&nbsp;&nbsp;&nbsp;Y</font><font face="Arial" color="#000100" size="2"><sub>ij</sub></font><font face="Arial" color="#000100" size="2"> </font><font face="Arial" color="#000100" size="3">~ Normal(</font><font face="Symbol" color="#000100" size="3">a</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> + </font><font face="Symbol" color="#000100" size="3">b</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">(</font><font face="Arial" color="#000100" size="2">t</font><font face="Arial" color="#000100" size="2"><sub>ij</sub></font><font face="Arial" color="#000100" size="3"> -t</font><font face="Arial" color="#000100" size="2"><sub>bar</sub></font><font face="Arial" color="#000100" size="3">), </font><font face="Symbol" color="#000100" size="3">t</font><font face="Arial" color="#000100" size="3">)<br><br>&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3">a</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> ~ Normal(</font><font face="Symbol" color="#000100" size="3">a</font><font face="Arial" color="#000100" size="2"><sub>c</sub></font><font face="Arial" color="#000100" size="3">, </font><font face="Symbol" color="#000100" size="3">t</font><font face="Symbol" color="#000100" size="2"><sub>a</sub></font><font face="Arial" color="#000100" size="3">)<br><br>&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3">b</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> ~ Normal(</font><font face="Symbol" color="#000100" size="3">b</font><font face="Arial" color="#000100" size="2"><sub>c</sub></font><font face="Arial" color="#000100" size="3">, </font><font face="Symbol" color="#000100" size="3">t</font><font face="Symbol" color="#000100" size="2"><sub>b</sub></font><font face="Arial" color="#000100" size="3">)<br><br>where </font><font face="Symbol" color="#000100" size="3">t</font><font face="Arial" color="#000100" size="3"> represents the </font><font face="Arial" color="#000100" size="3"><em>precision</em></font><font face="Arial" color="#000100" size="3"> (1/variance) of a normal distribution. We note the absence of a parameter representing correlation between </font><font face="Symbol" color="#000100" size="3">a</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> and </font><font face="Symbol" color="#000100" size="3">b</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> unlike in Gelfand </font><font face="Arial" color="#000100" size="3"><em>et al</em></font><font face="Arial" color="#000100" size="3"> 1990. However, see the </font><font face="Courier" color="#000100" size="3">Birats</font><font face="Arial" color="#000100" size="3"> example in Volume 2 which does explicitly model the covariance between </font><font face="Symbol" color="#000100" size="3">a</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> and </font><font face="Symbol" color="#000100" size="3">b</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3">. <br><br></font><font face="Symbol" color="#000100" size="3">a</font><font face="Arial" color="#000100" size="2"><sub>c</sub></font><font face="Arial" color="#000100" size="3"> , </font><font face="Symbol" color="#000100" size="3">t</font><font face="Symbol" color="#000100" size="2"><sub>a</sub></font><font face="Symbol" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">, </font><font face="Symbol" color="#000100" size="3">b</font><font face="Arial" color="#000100" size="2"><sub>c</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">, </font><font face="Symbol" color="#000100" size="3">t</font><font face="Symbol" color="#000100" size="2"><sub>b</sub></font><font face="Symbol" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">, </font><font face="Symbol" color="#000100" size="3">t</font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">are given independent ``noninformative'' priors. <br></font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="3"><center></font><font face="Arial" color="#000100" size="3"><em>Graphical model for hep example:</em></font><font face="Arial" color="#0000FF" size="5"><strong><br><img src="hepatitis1.bmp" alt="[hepatitis1]"></strong></font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="3"><br><br>BUGS</font><font face="Arial" color="#000100" size="3"><em> language for hep example:</em></font><font face="Arial" color="#000100" size="3"><br></font><font face="Arial" color="#000100" size="2"></center></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">model<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">{<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">for( i in 1 : N ) {<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">for( j in 1 : T ) {<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">Y[i , j] ~ dnorm(mu[i , j],tau)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">mu[i , j] &lt;- alpha[i] + beta[i] * (t[i,j] - 6.5) + <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gamma * (y0[i] - mean(y0[]))<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">}<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">alpha[i] ~ dnorm(alpha0,tau.alpha)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">beta[i] ~ dnorm(beta0,tau.beta)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">}<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">tau ~ dgamma(0.001,0.001)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">sigma &lt;- 1 / sqrt(tau)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">alpha0 ~ dnorm(0.0,1.0E-6)&nbsp;&nbsp;&nbsp;<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">tau.alpha ~ dgamma(0.001,0.001)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">beta0 ~ dnorm(0.0,1.0E-6)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">tau.beta ~ dgamma(0.001,0.001)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">gamma ~ dnorm(0.0,1.0E-6)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">}<br></font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="3"><br>Note the use of a very flat but conjugate prior for the population effects: a locally uniform prior could also have been used.<br></font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#0000FF" size="5"><a href="../Examples/Hepatitisdata.html"></font><font face="Arial" color="#0000FF" size="5"><u>Data</u></font><font face="Arial" color="#0000FF" size="5"></a></font><font face="Arial" color="#000100" size="3"> ( click to open )</font><font face="Arial" color="#0000FF" size="5"><br></font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#0000FF" size="5"><a href="../Examples/Hepatitisinits.html"></font><font face="Arial" color="#0000FF" size="5"><u>Inits&nbsp;for&nbsp;chain&nbsp;1</a></u></font><font face="Arial" color="#000100" size="3"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#0000FF" size="5"><a href="../Examples/Hepatitisinits1.html"></font><font face="Arial" color="#0000FF" size="5"><u>Inits&nbsp;for&nbsp;chain&nbsp;2</a></u></font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;( click to open )</font><font face="Arial" color="#0000FF" size="5"><br></font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#0000FF" size="5">Results<br><center><br><img src="hepatitis2.bmp" alt="[hepatitis2]"><br></font><font face="Arial" color="#000100" size="3"><br></center>With measurement error<br><center></font><font face="Arial" color="#000000" size="3"><br></font><font face="Arial" color="#0000FF" size="5"><img src="hepatitis3.bmp" alt="[hepatitis3]"><br></font><font face="Arial" color="#000100" size="1"></center></font><font face="Arial" color="#0000FF" size="5"><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">model<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tau.alpha ~ dgamma(0.001,0.001)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;alpha0 ~ dnorm( 0.0,1.0E-6)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;beta0 ~ dnorm( 0.0,1.0E-6)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tau.beta ~ dgamma(0.001,0.001)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for( i in 1 : N ) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;alpha[i] ~ dnorm(alpha0,tau.alpha)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;beta[i] ~ dnorm(beta0,tau.beta)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y0[i] ~ dnorm(mu0[i],tau)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mu0[i] ~ dnorm(theta,psi)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for( j in 1 : T ) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for( i in 1 : N ) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Y[i , j] ~ dnorm(mu[i , j],tau)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mu[i , j] &lt;- alpha[i] + beta[i] * (t[i , j] - 6.5) + <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gamma * (mu0[i] - mean(y0[]))<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tau ~ dgamma(0.001,0.001)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sigma &lt;- 1 / sqrt(tau)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gamma ~ dnorm( 0.0,1.0E-6)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;theta ~ dnorm( 0.0,1.0E-6)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;psi ~ dgamma(0.001,0.001)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</font><font face="Arial" color="#000100" size="1"><br><br><br></font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#0000FF" size="5"><a href="../Examples/HepatitisMEdata.html"></font><font face="Arial" color="#0000FF" size="5"><u>Data</u></font><font face="Arial" color="#0000FF" size="5"></a></font><font face="Arial" color="#000100" size="3"> ( click to open )</font><font face="Arial" color="#0000FF" size="5"><br></font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#0000FF" size="5"><a href="../Examples/HepatitisMEinits.html"></font><font face="Arial" color="#0000FF" size="5"><u>Inits&nbsp;for&nbsp;chain&nbsp;1</u></font><font face="Arial" color="#0000FF" size="5"></a></font><font face="Arial" color="#000100" size="3"> &nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#0000FF" size="5"><a href="../Examples/HepatitisMEinits1.html"></font><font face="Arial" color="#0000FF" size="5"><u>Inits&nbsp;for&nbsp;chain&nbsp;2</u></font><font face="Arial" color="#0000FF" size="5"></a></font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;( click to open )</font><font face="Arial" color="#0000FF" size="5"><br></font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#0000FF" size="5"><br>Results</font><font face="Arial" color="#000100" size="1"><br><center><br><img src="hepatitis4.bmp" alt="[hepatitis4]"></font></center></p></body></html>