<!DOCTYPE html PUBLIC "-//W3C//DTD Html 1.0 Strict//EN" "http://www.w3.org/TR/Html1/DTD/strict.dtd"><html><head><title>Pigweights</title></head><body><p><font face="Arial" color="#000100" size="1"></font><font face="Arial" color="#0000FF" size="6"><img src="pigweights0.bmp" alt="[pigweights0]">&nbsp;&nbsp;&nbsp;</font><font face="Courier New" color="#000100" size="6">Pig Weight Gain</font><font face="Arial" color="#0000FF" size="6"><br></font><font face="Arial" color="#0000FF" size="3"><br></font><font face="Arial" color="#000000" size="3">Histogram smoothing adapted from Example 5.9 from Congdon (2001), p 180. The model illustrates a structured precision matrix for a multivariate normal prior on a multinomial logistic regression model. The model can also be formulated in terms of a structured covariance matrix (see the commented out section of the model) which has a form with elements that decay exponentialy with absolute value of difference in index.</font><font face="Arial" color="#000100" size="3"><br></font><font face="Arial" color="#000000" size="3"><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">model{ <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y[1:s] ~ dmulti(th[1 : s] , n)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sum.g &lt;- sum(g[])<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3"># smoothed frequencies<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">&nbsp;&nbsp;&nbsp;for (i in 1 : s) { <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sm[i] &lt;- n * th[i]<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;g[i] &lt;- exp(gam[i]) <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;th[i] &lt;- g[i] / sum.g<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3"># prior on elements of AR Precision Matrix <br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">&nbsp;&nbsp;&nbsp;rho ~ dunif(0, 1)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">&nbsp;&nbsp;&nbsp;tau ~ dunif(0.5, 10)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3"># MVN for logit parameters<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">&nbsp;&nbsp;&nbsp;gam[1 : s] ~ dmnorm(mu[], T[ , ])<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">&nbsp;&nbsp;&nbsp;for (j in 1:s) { <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mu[j] &lt;- -log(s)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;# Define Precision Matrix<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for (j in 2 : s - 1) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;T[j, j] &lt;- tau * (1 + pow(rho, 2))<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;T[1, 1] &lt;- tau <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;T[s, s] &lt;- tau<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for (j in 1 : s -1 ) { <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;T[j, j + 1] &lt;- -tau * rho<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;T[j + 1, j] &lt;- T[j, j + 1]<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for (i in 1 : s - 1) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for (j in 2 + i : s) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;T[i, j] &lt;- 0; T[j, i] &lt;- 0 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3"># Or Could do in terms of covariance, which is simpler to write but slower<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for (i in 1 : s) {<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for (j in 1 : s) {<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cov[i, j] &lt;- pow(rho, abs(i - j)) / tau<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;T[1 : s, 1 : s] &lt;- inverse(cov[ , ])<br>&nbsp;&nbsp;&nbsp;}<br></font><font face="Arial" color="#000000" size="3"><br></font><font face="Arial" color="#0000FF" size="5"><a href="../Examples/Pigweightsdata.html"></font><font face="Arial" color="#0000FF" size="5"><u>Data</u></font><font face="Arial" color="#0000FF" size="5"></a></font><font face="Arial" color="#000000" size="5"> </font><font face="Arial" color="#000000" size="3">( click to open )</font><font face="Arial" color="#000100" size="3"><br></font><font face="Arial" color="#0000FF" size="5"><br><a href="../Examples/Pigweightsinits.html"></font><font face="Arial" color="#0000FF" size="5"><u>Inits&nbsp;for&nbsp;chain&nbsp;1</a></u></font><font face="Arial" color="#000000" size="3"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#0000FF" size="5"><a href="../Examples/Pigweightsinits1.html"></font><font face="Arial" color="#0000FF" size="5"><u>Inits&nbsp;for&nbsp;chain&nbsp;2</a></u></font><font face="Arial" color="#000000" size="3">&nbsp;&nbsp;&nbsp;( click to open )</font><font face="Arial" color="#0000FF" size="5"><br></font><font face="Arial" color="#000100" size="3"><br></font><font face="Arial" color="#0000FF" size="5">Results<br><center><br><img src="pigweights1.bmp" alt="[pigweights1]"></font></center></p></body></html>