<!DOCTYPE html PUBLIC "-//W3C//DTD Html 1.0 Strict//EN" "http://www.w3.org/TR/Html1/DTD/strict.dtd"><html><head><title>Stacks</title></head><body><p><font face="Arial" color="#000100" size="2"></font><font face="Arial" color="#000100" size="3"><strong><img src="stacks0.bmp" alt="[stacks0]">&nbsp;&nbsp;&nbsp;</strong></font><font face="Courier New" color="#000100" size="6">Stacks: robust regression</font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="3">Birkes and Dodge (1993) apply different regression models to the much-analysed stack-loss data of Brownlee (1965). This features 21 daily responses of stack loss y, the amount of ammonia escaping, with covariates being air flow x</font><font face="Arial" color="#000100" size="3"><sub>1</sub></font><font face="Arial" color="#000100" size="3">, temperature x</font><font face="Arial" color="#000100" size="3"><sub>2</sub></font><font face="Arial" color="#000100" size="3"> and acid concentration x</font><font face="Arial" color="#000100" size="3"><sub>3</sub></font><font face="Arial" color="#000100" size="3">. Part of the data is shown below.<br><img src="stacks1.bmp" alt="[stacks1]"></font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="2"><sub>&nbsp;&nbsp;&nbsp;</sub></font><font face="Arial" color="#000100" size="3"><sub><br></sub></font><font face="Arial" color="#000100" size="3">We first assume a linear regression on the expectation of y, with a variety of different error structures. Specifically</font><font face="Arial" color="#000100" size="3"><sub>&nbsp;&nbsp;&nbsp;<br><br></sub></font><font face="Arial" color="#000100" size="2"><sub>&nbsp;&nbsp;&nbsp;</sub></font><font face="Arial" color="#000100" size="3"><sub>&nbsp;&nbsp;&nbsp;</sub></font><font face="Symbol" color="#000100" size="3"><sub>m</sub></font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"><sub> = </sub></font><font face="Symbol" color="#000100" size="3"><sub>b</sub></font><font face="Arial" color="#000100" size="2"><sub>0</sub></font><font face="Arial" color="#000100" size="3"><sub> + </sub></font><font face="Symbol" color="#000100" size="3"><sub>b</sub></font><font face="Arial" color="#000100" size="2"><sub>1</sub></font><font face="Arial" color="#000100" size="3"><sub>z</sub></font><font face="Arial" color="#000100" size="2"><sub>1i</sub></font><font face="Arial" color="#000100" size="3"><sub> + </sub></font><font face="Symbol" color="#000100" size="3"><sub>b</sub></font><font face="Arial" color="#000100" size="2"><sub>2</sub></font><font face="Arial" color="#000100" size="3"><sub>z</sub></font><font face="Arial" color="#000100" size="2"><sub>2i</sub></font><font face="Arial" color="#000100" size="3"><sub> + </sub></font><font face="Symbol" color="#000100" size="3"><sub>b</sub></font><font face="Arial" color="#000100" size="2"><sub>3</sub></font><font face="Arial" color="#000100" size="3"><sub>z</sub></font><font face="Arial" color="#000100" size="2"><sub>3i</sub></font><font face="Arial" color="#000100" size="3"><sub><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y</sub></font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"><sub> ~ Normal(</sub></font><font face="Symbol" color="#000100" size="3"><sub>m</sub></font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"><sub>, </sub></font><font face="Symbol" color="#000100" size="3"><sub>t</sub></font><font face="Arial" color="#000100" size="3"><sub>)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y</sub></font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"><sub> ~ Double exp(</sub></font><font face="Symbol" color="#000100" size="3"><sub>m</sub></font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"><sub>, </sub></font><font face="Symbol" color="#000100" size="3"><sub>t</sub></font><font face="Arial" color="#000100" size="3"><sub>)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y</sub></font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"><sub> ~ t(</sub></font><font face="Symbol" color="#000100" size="3"><sub>m</sub></font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"><sub>, </sub></font><font face="Symbol" color="#000100" size="3"><sub>t</sub></font><font face="Arial" color="#000100" size="3"><sub>, d)<br>&nbsp;&nbsp;&nbsp;<br></sub></font><font face="Arial" color="#000100" size="3">where z</font><font face="Arial" color="#000100" size="2"><sub>ij</sub></font><font face="Arial" color="#000100" size="3"> = (x</font><font face="Arial" color="#000100" size="2"><sub>ij</sub></font><font face="Arial" color="#000100" size="3"> - xbar</font><font face="Arial" color="#000100" size="2"><sub>j</sub></font><font face="Arial" color="#000100" size="3">) /sd(x</font><font face="Arial" color="#000100" size="2"><sub>j</sub></font><font face="Arial" color="#000100" size="3">) are covariates standardised to have zero mean and unit variance. </font><font face="Symbol" color="#000100" size="3">b</font><font face="Arial" color="#000100" size="2"><sub>1</sub></font><font face="Arial" color="#000100" size="3">, </font><font face="Symbol" color="#000100" size="3">b</font><font face="Arial" color="#000100" size="2"><sub>2</sub></font><font face="Arial" color="#000100" size="3">, </font><font face="Symbol" color="#000100" size="3">b</font><font face="Arial" color="#000100" size="2"><sub>3</sub></font><font face="Arial" color="#000100" size="3"> are initially given independent &quot;noninformative&quot; priors. <br><br>Maximum likelihood estimates for the double expontential (Laplace) distribution are essentially equivalent to minimising the sum of absolute deviations (LAD), while the other options are alternative heavy-tailed distributions. A t on 4 degrees of freedom has been chosen, although with more data it would be possible to allow this parameter also to be unknown.<br><br>We also consider the use of 'ridge regression', intended to avoid the instability due to correlated covariates. This has been shown Lindley and Smith (1972) to be equivalent to assuming the regression coefficients of the standardised covariates to be exchangeable, so that </font><font face="Arial" color="#000100" size="3"><sub>&nbsp;&nbsp;&nbsp;<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</sub></font><font face="Symbol" color="#000100" size="3"><sub>b</sub></font><font face="Arial" color="#000100" size="2"><sub>j</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3"><sub>~ Normal(0,</sub></font><font face="Symbol" color="#000100" size="3"><sub> f</sub></font><font face="Arial" color="#000100" size="3"><sub>), j = 1, 2, 3.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br></sub></font><font face="Arial" color="#000100" size="3">In the following example we extend the work of Birkes and Dodge (1993) by applying this ridge technique to each of the possible error distributions.<br><br>Birkes and Dodge (1993) suggest investigating outliers by examining residuals y</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> - </font><font face="Symbol" color="#000100" size="3">m</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> greater than 2.5 standard deviations. We can calculate standardised residuals for each of these distributions, and create a variable outlier[i] taking on the value 1 whenever this condition is fulfilled. Mean values of outlier[i] then show the confidence with which this definition of outlier is fulfilled.<br><br>The </font><font face="Arial" color="#000100" size="3"><em>BUGS</em></font><font face="Arial" color="#000100" size="3"> language for all the models is shown below, with all models except the normal linear regression commented out:<br></font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;model<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;{<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;# Standardise x's and coefficients<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for (j in 1 : p) {<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b[j] &lt;- beta[j] / sd(x[ , j ]) <br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for (i in 1 : N) {<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;z[i, j] &lt;- (x[i, j] - mean(x[, j])) / sd(x[ , j]) <br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b0 &lt;- beta0 - b[1] * mean(x[, 1]) - b[2] * mean(x[, 2]) - b[3] * mean(x[, 3])<br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;# Model<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;d &lt;- 4; # degrees of freedom for t<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;for (i in 1 : N) {<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Y[i] ~ dnorm(mu[i], tau)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Y[i] ~ ddexp(mu[i], tau)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Y[i] ~ dt(mu[i], tau, d)<br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mu[i] &lt;- beta0 + beta[1] * z[i, 1] + beta[2] * z[i, 2] + beta[3] * z[i, 3]<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;stres[i] &lt;- (Y[i] - mu[i]) / sigma<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;outlier[i] &lt;- step(stres[i] - 2.5) + step(-(stres[i] + 2.5) )<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;# Priors <br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;beta0 ~ dnorm(0, 0.00001)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for (j in 1 : p) {<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;beta[j] ~ dnorm(0, 0.00001) &nbsp;&nbsp;&nbsp;# coeffs independent<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;beta[j] ~ dnorm(0, phi) # coeffs exchangeable (ridge regression)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tau ~ dgamma(1.0E-3, 1.0E-3)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;phi ~ dgamma(1.0E-2,1.0E-2)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;# standard deviation of error distribution<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sigma &lt;- sqrt(1 / tau) # normal errors<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;&nbsp;sigma &lt;- sqrt(2) / tau # double exponential errors<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;&nbsp;sigma &lt;- sqrt(d / (tau * (d - 2))); # t errors on d degrees of freedom<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;}</font><font face="Arial" color="#000100" size="3"><br></font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#0000FF" size="3"><a href="../Examples/Stacksdata.html"></font><font face="Arial" color="#0000FF" size="5"><u>Data</u></font><font face="Arial" color="#0000FF" size="5"></a></font><font face="Arial" color="#000000" size="3"> ( click to open )</font><font face="Arial" color="#000100" size="3"><br></font><font face="Arial" color="#0000FF" size="5"><br></font><font face="Arial" color="#0000FF" size="3"><a href="../Examples/Stacksinits.html"></font><font face="Arial" color="#0000FF" size="5"><u>Inits&nbsp;for&nbsp;chain&nbsp;1</a></u></font><font face="Arial" color="#000000" size="3"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#0000FF" size="3"><a href="../Examples/Stacksinits1.html"></font><font face="Arial" color="#0000FF" size="5"><u>Inits&nbsp;for&nbsp;chain&nbsp;2</a></u></font><font face="Arial" color="#000000" size="3">&nbsp;&nbsp;&nbsp;( click to open )</font><font face="Arial" color="#0000FF" size="5"><br></font><font face="Arial" color="#000000" size="2"><br></font><font face="Arial" color="#0000FF" size="5">Results</font><font face="Arial" color="#000000" size="2"><br></font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000000" size="3"><strong>a) Normal error</strong></font><font face="Arial" color="#000000" size="3"> <br><br>A 1000 update burn in followed by a further 10000 updates gave the parameter estimates<br><center></font><font face="Arial" color="#000100" size="3"><br><img src="stacks2.bmp" alt="[stacks2]"><br><br></font><font face="Arial" color="#000100" size="3"><strong></center>b) Double exponential error</strong></font><font face="Arial" color="#000100" size="3"><br><br>A </font><font face="Arial" color="#000000" size="3">1000 update burn in followed by a further 10000 updates gave the parameter estimates<br><center></font><font face="Arial" color="#000100" size="3"><br><img src="stacks3.bmp" alt="[stacks3]"><br><br></font><font face="Arial" color="#000100" size="3"><strong></center>c) t4 error</strong></font><font face="Arial" color="#000000" size="3"> <br><br>A 1000 update burn in followed by a further 10000 updates gave the parameter estimates<br><center></font><font face="Arial" color="#000100" size="3"><br><img src="stacks4.bmp" alt="[stacks4]"><br><br></font><font face="Arial" color="#000100" size="3"><strong></center>d) Normal eror ridge regression </strong></font><font face="Arial" color="#000100" size="3"><br><br>A</font><font face="Arial" color="#000000" size="3"> 1000 update burn in followed by a further 10000 updates gave the parameter estimates<br><center></font><font face="Arial" color="#000100" size="3"><br><img src="stacks5.bmp" alt="[stacks5]"><br><br></font><font face="Arial" color="#000100" size="3"><strong></center>e) Double exponential error ridge regression</strong></font><font face="Arial" color="#000100" size="3"> <br><br>A</font><font face="Arial" color="#000000" size="3"> 1000 update burn in followed by a further 10000 updates gave the parameter estimates<br><center></font><font face="Arial" color="#000100" size="3"><br><br><img src="stacks6.bmp" alt="[stacks6]"><br></font><font face="Arial" color="#000100" size="3"><strong></center>f) t4 error ridge regression</strong></font><font face="Arial" color="#000100" size="3"> <br><br>A</font><font face="Arial" color="#000000" size="3"> 1000 update burn in followed by a further 10000 updates gave the parameter estimates<br><center></font><font face="Arial" color="#000100" size="3"><br><img src="stacks7.bmp" alt="[stacks7]"></font><font face="Arial" color="#000100" size="2"><br></center></font><font face="Arial" color="#000100" size="3"><br>We note the similar results between the Birkes and Dodge methods and </font><font face="Arial" color="#000100" size="3"><em>BUGS</em></font><font face="Arial" color="#000100" size="3">, and the lack of influence of the ridge technique in this context. <br></font><font face="Arial" color="#000100" size="2"><br></font></p></body></html>