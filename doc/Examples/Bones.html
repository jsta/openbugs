<!DOCTYPE html PUBLIC "-//W3C//DTD Html 1.0 Strict//EN" "http://www.w3.org/TR/Html1/DTD/strict.dtd"><html><head><title>Bones</title></head><body><p><font face="Arial" color="#000100" size="2"></font><font face="Arial" color="#000100" size="3"><strong><img src="bones0.bmp" alt="[bones0]"></strong></font><font face="Arial" color="#0000FF" size="5"><strong>&nbsp;&nbsp;&nbsp;</strong></font><font face="Courier New" color="#000100" size="6">Bones: latent trait model <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for multiple ordered<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;categorical responses</font><font face="Arial" color="#000100" size="1"><br></font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="3"><br>The concept of skeletal age (SA) arises from the idea that individuals mature at different rates: for any given chronological age (CA), the </font><font face="Arial" color="#000100" size="3"><em>average</em></font><font face="Arial" color="#000100" size="3"> SA in a sample of individuals should equal their CA, but with an inter-individual spread which reflects the differential rate of maturation. Roche et al (1975) have developed a model for predicting SA by calibrating 34 indicators (items) of skeletal maturity which may be observed in a radiograph. Each indicator is categorized with respect to its degree of maturity: 19 are binary items (i.e. 0 = immature or 1 = mature); 8 items have 3 grades (i.e. 0 = immature; 1 = partially mature; 2 = fully mature); 1 item has 4 ordered grades and the remaining 6 items have 5 ordered grades of maturity. Roche </font><font face="Arial" color="#000100" size="3"><em>et al.</em></font><font face="Arial" color="#000100" size="3"> calculated threshold parameters for the boundarys between grades for each indicator. For the binary items, there is a single threshold representing the CA at which 50% of individuals are mature for the indicator. Three-category items have 2 threshold parameters: the first corresponds to the CA at which 50% of individuals are either partially or fully mature for the indicator; the second is the CA at which 50% of individuals are fully mature. Four and five-category items have 3 and 4 threshold parameters respectively, which are interpreted in a similar manner to those for 3-category items. In addition, Roche </font><font face="Arial" color="#000100" size="3"><em>et al. </em></font><font face="Arial" color="#000100" size="3">calculated a discriminability (slope) parameter for each item which reflects its rate of maturation. Part of this data is shown below. Columns 1--4 represent the threshold parameters (note the use of the missing value code NA to `fill in' the columns for items with fewer than 4 thresholds); column 5 is the discriminability parameter; column 6 gives the number of grades per item.<br><center><br></font><font face="Arial" color="#000100" size="2"><img src="bones1.bmp" alt="[bones1]"></font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;<br></center>Thissen (1986) (p.71) presents the following graded radiograph data on 13 boys whose chronological ages range from 6 months to 18 years. (Note that for ease of implementation in </font><font face="Arial" color="#000100" size="3"><em>BUGS</em></font><font face="Arial" color="#000100" size="3"> we have listed the items in a different order to that used by Thissen):<br><center><br></font><font face="Arial" color="#000100" size="2"><img src="bones2.bmp" alt="[bones2]"></font><font face="Arial" color="#000100" size="3"><br></center>Some items have missing data (represented by the code NA in the table above). This does not present a problem for </font><font face="Arial" color="#000100" size="3"><em>BUGS</em></font><font face="Arial" color="#000100" size="3">: the missing grades are simply treated as unknown parameters to be estimated along with the other parameters of interest such as the SA for each boy.<br><br>Thissen models the above data using the logistic function. For each item </font><font face="Arial" color="#000100" size="3"><em>j</em></font><font face="Arial" color="#000100" size="3"> and each grade </font><font face="Arial" color="#000100" size="3"><em>k</em></font><font face="Arial" color="#000100" size="3">, the cumulative probability Q</font><font face="Arial" color="#000100" size="2"><sub>jk</sub></font><font face="Arial" color="#000100" size="3"> that a boy with skeletal age </font><font face="Symbol" color="#000100" size="3">q</font><font face="Arial" color="#000100" size="3"> is assigned a more mature grade than </font><font face="Arial" color="#000100" size="3"><em>k</em></font><font face="Arial" color="#000100" size="3"> is given by<br><br>&nbsp;&nbsp;&nbsp;logitQ</font><font face="Arial" color="#000100" size="2"><sub>jk</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">= </font><font face="Symbol" color="#000100" size="3">d</font><font face="Arial" color="#000100" size="2"><sub>j</sub></font><font face="Arial" color="#000100" size="3">(</font><font face="Symbol" color="#000100" size="3">q</font><font face="Arial" color="#000100" size="3"> - </font><font face="Symbol" color="#000100" size="3">g</font><font face="Arial" color="#000100" size="2"><sub>jk</sub></font><font face="Arial" color="#000100" size="3">)<br>&nbsp;&nbsp;&nbsp;<br>where </font><font face="Symbol" color="#000100" size="3">d</font><font face="Arial" color="#000100" size="2"><sub>j</sub></font><font face="Arial" color="#000100" size="3"> is the discriminability parameter and the </font><font face="Symbol" color="#000100" size="3">g</font><font face="Arial" color="#000100" size="2"><sub>jk</sub></font><font face="Arial" color="#000100" size="3"> are the threshold parameters for item </font><font face="Arial" color="#000100" size="3"><em>j</em></font><font face="Arial" color="#000100" size="3">. Hence the probability of observing an immature grade (i.e. k =1) for a particular skeletal age </font><font face="Symbol" color="#000100" size="3">q</font><font face="Arial" color="#000100" size="3"> is p</font><font face="Arial" color="#000100" size="2"><sub>j,1</sub></font><font face="Arial" color="#000100" size="3"> = 1 - Q</font><font face="Arial" color="#000100" size="2"><sub>j,1</sub></font><font face="Arial" color="#000100" size="3">. The probability of observing a fully mature grade (i.e.k = K</font><font face="Arial" color="#000100" size="2"><sub>j</sub></font><font face="Arial" color="#000100" size="3">, where K</font><font face="Arial" color="#000100" size="2"><sub>j</sub></font><font face="Arial" color="#000100" size="3"> is the number of grades for item </font><font face="Arial" color="#000100" size="3"><em>j </em></font><font face="Arial" color="#000100" size="3">is p</font><font face="Arial" color="#000100" size="2"><sub>j</sub></font><font face="Arial" color="#000100" size="3"><sub>,K</sub></font><font face="Arial" color="#000100" size="2"><sub>j</sub></font><font face="Arial" color="#000100" size="3"> = Q</font><font face="Arial" color="#000100" size="2"><sub>j</sub></font><font face="Arial" color="#000100" size="3"><sub>,K</sub></font><font face="Arial" color="#000100" size="2"><sub>j</sub></font><font face="Arial" color="#000100" size="2"><sub> -1</sub></font><font face="Arial" color="#000100" size="3">. For items with 3 or more categories, the probability of observing an itermediate grade is p</font><font face="Arial" color="#000100" size="2"><sub>j,k</sub></font><font face="Arial" color="#000100" size="3"> = Q</font><font face="Arial" color="#000100" size="2"><sub>j,k-1</sub></font><font face="Arial" color="#000100" size="3"> - Q</font><font face="Arial" color="#000100" size="2"><sub>j,k</sub></font><font face="Arial" color="#000100" size="3"> (i.e. the difference between the cumulative probability of being assigned grade </font><font face="Arial" color="#000100" size="3"><em>k</em></font><font face="Arial" color="#000100" size="3"> or more, and of being assigned grade </font><font face="Arial" color="#000100" size="3"><em>k+1</em></font><font face="Arial" color="#000100" size="3"> or more). <br><br>The </font><font face="Arial" color="#000100" size="3"><em>BUGS</em></font><font face="Arial" color="#000100" size="3"> language for this model is given below. Note that the </font><font face="Symbol" color="#000100" size="3">q</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> for each boy </font><font face="Arial" color="#000100" size="3"><em>i</em></font><font face="Arial" color="#000100" size="3"> is assigned a vague, independent normal prior theta[i] ~ dnorm(0.0, 0.001). That is, each boy is treated as a separate problem with is no `learning' or `borrowing strength' across individuals, and hence no hierachical structure on the </font><font face="Symbol" color="#000100" size="3">q</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3">'s.<br><center><br><br>BUGS</font><font face="Arial" color="#000100" size="3"><em> language for bones example</em></font><font face="Arial" color="#000100" size="3"><br><br></font><font face="Arial" color="#000100" size="2"></center></font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;model<br>&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for (i in 1 : nChild) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;theta[i] ~ dnorm(0.0, 0.001)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for (j in 1 : nInd) { <br>&nbsp;&nbsp;&nbsp;# Cumulative probability of &gt; grade k given theta<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for (k in 1: ncat[j] - 1) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logit(Q[i, j, k]) &lt;- delta[j] * (theta[i] - gamma[j, k])<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br><br>&nbsp;&nbsp;&nbsp;# Probability of observing grade k given theta<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for (j in 1 : nInd) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p[i, j, 1] &lt;- 1 - Q[i, j, 1]<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for (k in 2 : ncat[j] - 1) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p[i, j, k] &lt;- Q[i, j, k - 1] - Q[i, j, k]<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p[i, j, ncat[j]] &lt;- Q[i, j, ncat[j] - 1]<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;grade[i, j] ~ dcat(p[i, j, 1 : ncat[j]])<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cumulative.grade[i, j] &lt;- cumulative(grade[i, j], grade[i, j])<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;} </font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="1"><br><br></font><font face="Arial" color="#0000FF" size="5"><a href="../Examples/Bonesdata.html"></font><font face="Arial" color="#0000FF" size="5"><u>Data</u></font><font face="Arial" color="#000100" size="5"></a></font><font face="Arial" color="#000100" size="3"> ( click to open )</font><font face="Arial" color="#000100" size="2"><br><br></font><font face="Arial" color="#0000FF" size="5"><a href="../Examples/Bonesinits.html"></font><font face="Arial" color="#0000FF" size="5"><u>Inits&nbsp;for&nbsp;chain&nbsp;1</u></font><font face="Arial" color="#0000FF" size="5"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3"></font><font face="Arial" color="#0000FF" size="5"><a href="../Examples/Bonesinits1.html"></font><font face="Arial" color="#0000FF" size="5"><u>Inits&nbsp;for&nbsp;chain&nbsp;2</u></font><font face="Arial" color="#0000FF" size="5"></a></font><font face="Arial" color="#000100" size="3">( click to open )</font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="3"><br></font><font face="Arial" color="#000100" size="3"><br>We note a couple of tricks used in the above code. Firstly, the variable p has been declared as a 3-way rectangular array with the size of the third dimension equal to the maximum number of possible grades (i.e.5) for all items (even though items 1--28 have fewer than 5 categories). The statement <br><br>&nbsp;&nbsp;&nbsp;grade[i, j] ~ dcat(p[i, j, 1 :ngrade[j]])<br><br>is then used to select the relevant elements of p[i,j, ] for item </font><font face="Arial" color="#000100" size="3"><em>j</em></font><font face="Arial" color="#000100" size="3">, thus ignoring any `empty' spaces in the array for items with fewer than the maximum number of grades. Secondly, the final section of the above code includes a loop indexed as follows <br><br></font><font face="Arial" color="#0000FF" size="5">Results </font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="3"><br></font><font face="Arial" color="#000000" size="3">A 1000 update burn in followed by a further 10000 updates gave the parameter estimates<br><center><br><img src="bones3.bmp" alt="[bones3]"></font></center></p></body></html>